{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/Publish/EditPage.jsx\";\nimport React from 'react';\nimport '../../App.css';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { saveAtt } from '../../redux/actions';\nimport { doUpload } from '../../functions/uploadEditPageFuncs/index';\n\nclass EditPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n    this.axiosSignal = axios.CancelToken.source();\n\n    this.checkIfAll = () => {\n      let check = true;\n      const selection = this.state.selection;\n      Object.keys(selection).forEach(key => {\n        if (key !== 'brand' && key !== 'descrtext') {\n          if (selection[key] === 0 && selection.category !== 3 || selection[key] === null || selection[key] === '') {\n            check = false;\n            this.setState({\n              warning: 'Izpolni vsa polja'\n            });\n          }\n        }\n      });\n\n      if (this.state.photos.length < 3 && this.state.photos.length !== 0) {\n        check = false;\n        this.setState({\n          warning: 'Izberi tri fotografije'\n        });\n      }\n\n      return check;\n    };\n\n    this.onImageSaved = (photo, index) => {\n      if (this.state.photos.length <= index) {\n        this.setState(state => {\n          const photos = state.photos.concat(photo);\n          return {\n            photos\n          };\n        });\n      } else {\n        this.setState(state => {\n          const photos = state.photos.map((item, j) => {\n            if (j === index) {\n              return photo;\n            } else {\n              return item;\n            }\n          });\n          return {\n            photos\n          };\n        });\n      }\n    };\n\n    this.onSelectionSaved = selection => {\n      this.setState({\n        selection\n      });\n    };\n\n    this.state = {\n      adId: '',\n      uploadedPhotos: [],\n      photos: [],\n      urls: [],\n      fileWarning: '',\n      warning: '',\n      srcsToPass: [],\n      editStatus: false,\n      selection: {\n        category: '',\n        subcategory: '',\n        clothsize: '',\n        material: '',\n        condition: '',\n        brand: '',\n        descrtext: '',\n        weight: null,\n        price: null\n      },\n      loading: false,\n      userId: '0'\n    };\n    this.handleUpload = this.handleUpload.bind(this);\n  }\n\n  componentDidMount() {\n    const adId = this.props.adId;\n\n    if (adId !== '') {\n      fetch('/fillform', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          adId: adId\n        })\n      }).then(res => res.json()).then(res => this.setState(state => {\n        let arr = [res[0].photo1_url, res[0].photo2_url, res[0].photo3_url];\n        let srcsToPass = state.srcsToPass.concat(arr);\n        return {\n          srcsToPass\n        };\n      })).catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    fetch('/sessionroutes', {\n      signal: this.abortController.signal\n    }).then(res => res.json()).then(res => this.setState({\n      userId: res.userId\n    }, () => console.log(this.state.userId))).catch(e => console.error(\"Critical failure: \" + e.message));\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n    this.axiosSignal.cancel('Api is being canceled');\n  }\n\n  handleUpload() {\n    this.props.saveAtt(true);\n\n    if (!this.checkIfAll()) {\n      this.setState({\n        warning: \"IZPOLNI VSA POLJA!\"\n      });\n    } else {\n      this.setState({\n        loading: true\n      });\n\n      if (this.state.photos.length === 3) {\n        doUpload('edit', this.state.selection, this.props.loggedInUserId, this.props.loggedInUser, this.axiosSignal, this.props.adId, this.state.photos).then(res => {\n          console.log(\"UPLOAD RESPONSE: \" + res.statusText);\n          this.setState({\n            editStatus: true,\n            loading: false\n          });\n        }).catch(e => console.error(\"Critical failure: \" + e.message));\n      } else {\n        doUpload('edit', this.state.selection, this.props.loggedInUserId, this.props.loggedInUser, this.abortController.signal, this.props.adId).then(res => {\n          console.log(res.json());\n          this.setState({\n            editStatus: true,\n            loading: false\n          });\n        }).catch(e => console.error(\"Critical failure: \" + e.message));\n      }\n    }\n  }\n\n  render() {\n    if (this.state.userId === '0') {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundColor: 'rgb(255,255,255,0.5)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 20\n        }\n      }, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 26\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 31\n        }\n      }), /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 21\n        }\n      }, \"PROSIMO PRIJAVITE SE V SISTEM!\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 26\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 31\n        }\n      }));\n    } else return this.props.render({\n      state: this.state,\n      onSelectionSaved: this.onSelectionSaved,\n      onImageSaved: this.onImageSaved,\n      handleUpload: this.handleUpload,\n      srcsToPass: this.state.srcsToPass\n    });\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nconst mapDispatchToProps = {\n  saveAtt: saveAtt\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(EditPage);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/Publish/EditPage.jsx"],"names":["React","axios","connect","saveAtt","doUpload","EditPage","Component","constructor","props","abortController","AbortController","axiosSignal","CancelToken","source","checkIfAll","check","selection","state","Object","keys","forEach","key","category","setState","warning","photos","length","onImageSaved","photo","index","concat","map","item","j","onSelectionSaved","adId","uploadedPhotos","urls","fileWarning","srcsToPass","editStatus","subcategory","clothsize","material","condition","brand","descrtext","weight","price","loading","userId","handleUpload","bind","componentDidMount","fetch","signal","method","headers","body","JSON","stringify","then","res","json","arr","photo1_url","photo2_url","photo3_url","catch","e","console","error","message","log","componentWillUnmount","abort","cancel","loggedInUserId","loggedInUser","statusText","render","backgroundColor","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../App.css';\nimport axios from 'axios';\nimport { connect } from 'react-redux';\nimport { saveAtt } from '../../redux/actions';\nimport {doUpload} from '../../functions/uploadEditPageFuncs/index';\n\n\nclass EditPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            adId: '',\n            uploadedPhotos: [],\n            photos: [],\n            urls: [],\n            fileWarning: '',\n            warning: '',\n            srcsToPass: [],\n            editStatus: false,\n            selection: {\n                category: '',\n                subcategory: '',\n                clothsize: '',\n                material: '',\n                condition: '',\n                brand: '',\n                descrtext: '',\n                weight: null,\n                price: null\n            },\n            loading: false,\n            userId: '0'\n        };\n        this.handleUpload = this.handleUpload.bind(this);\n    }\n\n    abortController = new AbortController();\n    axiosSignal = axios.CancelToken.source();\n\n    componentDidMount() {\n\n        const adId = this.props.adId;\n\n        if(adId !== '') {\n            fetch('/fillform', {\n                signal: this.abortController.signal,\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                },\n                body: JSON.stringify({adId: adId})\n            }).then(res => res.json())\n                .then(res => this.setState(state => {\n                    let arr = [res[0].photo1_url, res[0].photo2_url, res[0].photo3_url];\n                    let srcsToPass = state.srcsToPass.concat(arr);\n                    return {srcsToPass};\n                    }))\n\n                .catch(e => console.error(\"Critical failure: \" + e.message));           \n        }\n\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => this.setState({userId: res.userId}, () => console.log(this.state.userId)))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n        this.axiosSignal.cancel('Api is being canceled');\n    }\n\n    checkIfAll = () => {\n        let check = true;\n        const selection = this.state.selection;\n        Object.keys(selection).forEach(key => {\n            if(key !== 'brand' && key !== 'descrtext') {\n                if((selection[key] === 0 && selection.category !== 3) || selection[key] === null || selection[key] === '') {\n                    check = false;\n                    this.setState({warning: 'Izpolni vsa polja'});\n                }\n            }\n        });\n        if (this.state.photos.length < 3 && this.state.photos.length !== 0) {\n            check = false;\n            this.setState({warning: 'Izberi tri fotografije'});\n        }\n        return check;\n    }\n\n    onImageSaved = (photo, index) => {\n\n        if (this.state.photos.length <= index) {\n            this.setState(state => {\n                const photos = state.photos.concat(photo);\n                return {photos};\n            });\n        } else {\n            this.setState(state => {\n                const photos = state.photos.map((item, j) => {\n                if (j === index) {\n                    return photo;\n                } else {\n                    return item;\n                }\n            });\n            return {photos};\n        });\n        }\n    }\n\n    onSelectionSaved = (selection) => {\n        this.setState({selection});\n    }\n\n    handleUpload() {\n\n        this.props.saveAtt(true);    \n        if (!this.checkIfAll()) {\n            this.setState({warning: \"IZPOLNI VSA POLJA!\"}); \n        }else {\n            this.setState({loading: true})\n            if(this.state.photos.length === 3) {\n                doUpload('edit', this.state.selection, this.props.loggedInUserId, this.props.loggedInUser, this.axiosSignal, this.props.adId, this.state.photos)\n                .then(res => {console.log(\"UPLOAD RESPONSE: \" + res.statusText); this.setState({editStatus: true, loading: false})})\n                .catch(e => console.error(\"Critical failure: \" + e.message));\n            } else {\n                doUpload('edit', this.state.selection, this.props.loggedInUserId, this.props.loggedInUser, this.abortController.signal, this.props.adId)\n                .then(res => {console.log(res.json()); this.setState({editStatus: true, loading: false})})\n                .catch(e => console.error(\"Critical failure: \" + e.message));\n            }\n        }\n    }\n\n    render() {\n\n        if(this.state.userId === '0') {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                    <br/><br/><br/>\n                    <h2>PROSIMO PRIJAVITE SE V SISTEM!</h2>\n                    <br/><br/><br/>\n                </div>\n        }\n        else return this.props.render({\n            state: this.state,\n            onSelectionSaved: this.onSelectionSaved,\n            onImageSaved: this.onImageSaved,\n            handleUpload: this.handleUpload,\n            srcsToPass: this.state.srcsToPass\n          })\n\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n};\n\nconst mapDispatchToProps = {\n    saveAtt: saveAtt\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps) (EditPage);\n"]},"metadata":{},"sourceType":"module"}