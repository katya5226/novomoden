{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/Listings/SearchResults.jsx\";\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport * as Constants from '../../constants';\n\nclass SearchResults extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.search = () => {\n      let searchFor = this.state.searchFor;\n      if (searchFor === '') searchFor = 'nothingtosearchfor';\n      fetch('/search', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          signal: this.abortController.signal,\n          searchFor: searchFor\n        })\n      }).then(res => res.json()).then(ads => this.setState({\n        ads: ads,\n        numPages: Math.floor(ads.length / this.state.adsPerPage + 0.99)\n      })).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.onSearchChange = searchFor => {\n      this.setState({\n        searchFor\n      }, () => this.search());\n    };\n\n    this.paginationButtonClick = e => {\n      // function subStrBeforeChars(str, char) {\n      //     return str.substring(0, str.indexOf(char));\n      // }\n      // const location = subStrBeforeChars(window.location.href, '?');\n      const location = window.location.href;\n      let newpage = 1;\n\n      switch (e.target.id) {\n        case 'first':\n          this.setState({\n            page: 1\n          }); //window.history.replaceState(null, \"\", location + '?1');\n\n          window.history.replaceState(null, \"\", location + '1');\n          break;\n\n        case 'previous':\n          this.state.page > 1 ? newpage = this.state.page - 1 : newpage = 1;\n          this.setState({\n            page: newpage\n          }); //window.history.replaceState(null, \"\", location + '?' + newpage);\n\n          window.history.replaceState(null, \"\", location + newpage);\n          break;\n\n        case 'next':\n          this.state.page < this.state.numPages ? newpage = this.state.page + 1 : newpage = this.state.numPages;\n          this.setState({\n            page: newpage\n          }); //window.history.replaceState(null, \"\", location + '?' + newpage);\n\n          window.history.replaceState(null, \"\", location + newpage);\n          break;\n\n        case 'last':\n          this.setState({\n            page: this.state.numPages\n          }); //window.history.replaceState(null, \"\", location + '?' + this.state.numPages);\n\n          window.history.replaceState(null, \"\", location + this.state.numPages);\n          break;\n\n        default:\n          return null;\n      }\n    };\n\n    this.toRender = ads => {\n      const imgStyle = {\n        width: \"100%\",\n        border: '2px solid white'\n      };\n      const wrapper = {\n        display: \"grid\",\n        gridTemplateColumns: \"repeat(4, 1fr)\",\n        gridGap: \"100px 100px\",\n        maxWidth: \"100%\",\n        margin: \"50px 50px\"\n      };\n      let searchFor = this.state.searchFor;\n\n      if (ads.length === 0) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            display: \"flex\",\n            maxWidth: \"90vw\",\n            minHeight: '30vh',\n            justifyContent: 'center'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"h2\", {\n          style: {\n            color: 'white'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 30\n          }\n        }, \"OPROSTITE, NI\\u010CESAR NISMO NA\\u0160LI!\")));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 124,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"p\", {\n          className: \"white-back\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 25\n          }\n        }, \"Rezultati iskanja za: \", /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 75\n          }\n        }, searchFor)), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            maxWidth: '100%',\n            justifyContent: 'center',\n            minHeight: '80vh'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          style: wrapper,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 127,\n            columnNumber: 29\n          }\n        }, ads.map(ad => {\n          let category = Constants.categoryNames[ad.category];\n          let subcategory;\n\n          switch (category) {\n            case 'women':\n              subcategory = Constants.women[ad.subcategory].value;\n              break;\n\n            case 'men':\n              subcategory = Constants.men[ad.subcategory].value;\n              break;\n\n            case 'kids':\n              subcategory = Constants.kids[ad.subcategory].value;\n              break;\n\n            default:\n              subcategory = 0;\n          }\n\n          return /*#__PURE__*/React.createElement(\"li\", {\n            key: ad.ad_id,\n            style: {\n              listStyleType: \"none\"\n            },\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 41\n            }\n          }, /*#__PURE__*/React.createElement(NavLink, {\n            exact: true,\n            to: '/listings/' + category + '/' + subcategory + '/item?' + ad.ad_id,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 145,\n              columnNumber: 94\n            }\n          }, /*#__PURE__*/React.createElement(\"img\", {\n            src: '/' + ad.photo1_url,\n            alt: ad.ad_id + 'somephoto',\n            style: imgStyle,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 147,\n              columnNumber: 45\n            }\n          })));\n        }))));\n      }\n    };\n\n    this.state = {\n      searchFor: '',\n      searchForLen: 0,\n      ads: [],\n      adsPerPage: 5,\n      numPages: 1,\n      page: 1\n    };\n  }\n\n  componentDidMount() {\n    function subStrAfterChars(str, char) {\n      return str.substring(str.indexOf(char) + 1);\n    }\n\n    function subStrBetweenChars(str, char1, char2) {\n      return str.substring(str.indexOf(char1) + 1, str.indexOf(char2) + 1);\n    }\n\n    const searchFor = subStrAfterChars(window.location.href, '?', '=');\n    console.log(searchFor);\n    this.setState({\n      searchForLen: searchFor.length\n    });\n    const page = subStrAfterChars(window.location.href, '?' + searchFor.length);\n    this.setState({\n      searchFor,\n      page\n    }, () => this.search());\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    const path = '/searchresults';\n    let numAds = this.state.ads.length;\n    let n = this.state.adsPerPage;\n    let p = this.state.page - 1;\n    let till;\n    p * n + n < numAds ? till = (p + 1) * n : till = numAds;\n    let adsPortion = this.state.ads.slice(p * n, till);\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      callBackParent: this.onSearchChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 26\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: path,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 26\n      }\n    }), this.toRender(adsPortion), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"button\", {\n      id: \"first\",\n      className: \"btn_nopad\",\n      onClick: this.paginationButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 177,\n        columnNumber: 29\n      }\n    }, \"PRVA\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"previous\",\n      className: \"btn_nopad\",\n      onClick: this.paginationButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 29\n      }\n    }, \"<<\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"current\",\n      className: \"btn_nopad\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 29\n      }\n    }, this.state.page, \"/\", this.state.numPages), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"next\",\n      className: \"btn_nopad\",\n      onClick: this.paginationButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 29\n      }\n    }, \">>\"), /*#__PURE__*/React.createElement(\"button\", {\n      id: \"last\",\n      className: \"btn_nopad\",\n      onClick: this.paginationButtonClick,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 29\n      }\n    }, \"ZADNJA\")), /*#__PURE__*/React.createElement(AdSpace, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 26\n      }\n    }));\n  }\n\n}\n\nexport default SearchResults;","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/Listings/SearchResults.jsx"],"names":["React","NavLink","UpperLine","Header","Bottom","BreadCrumbs","NavBar","AdSpace","Constants","SearchResults","Component","constructor","props","abortController","AbortController","search","searchFor","state","fetch","method","headers","body","JSON","stringify","signal","then","res","json","ads","setState","numPages","Math","floor","length","adsPerPage","catch","e","console","error","message","onSearchChange","paginationButtonClick","location","window","href","newpage","target","id","page","history","replaceState","toRender","imgStyle","width","border","wrapper","display","gridTemplateColumns","gridGap","maxWidth","margin","minHeight","justifyContent","color","map","ad","category","categoryNames","subcategory","women","value","men","kids","ad_id","listStyleType","photo1_url","searchForLen","componentDidMount","subStrAfterChars","str","char","substring","indexOf","subStrBetweenChars","char1","char2","log","componentWillUnmount","abort","render","path","numAds","n","p","till","adsPortion","slice"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,OAAT,QAAwB,kBAAxB;AACA,OAAOC,SAAP,MAAsB,4BAAtB;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,OAAOC,WAAP,MAAwB,8BAAxB;AACA,OAAOC,MAAP,MAAmB,yBAAnB;AACA,OAAOC,OAAP,MAAoB,0BAApB;AACA,OAAO,KAAKC,SAAZ,MAA2B,iBAA3B;;AAGA,MAAMC,aAAN,SAA4BT,KAAK,CAACU,SAAlC,CAA4C;AAE3CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAClB,UAAMA,KAAN;AADkB,SAYhBC,eAZgB,GAYE,IAAIC,eAAJ,EAZF;;AAAA,SA+BhBC,MA/BgB,GA+BP,MAAM;AACX,UAAIC,SAAS,GAAG,KAAKC,KAAL,CAAWD,SAA3B;AACA,UAAIA,SAAS,KAAK,EAAlB,EAAsBA,SAAS,GAAG,oBAAZ;AACtBE,MAAAA,KAAK,CAAC,SAAD,EAAY;AACbC,QAAAA,MAAM,EAAE,MADK;AAEbC,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,oBAAU;AAFL,SAFI;AAMbC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,UAAAA,MAAM,EAAE,KAAKX,eAAL,CAAqBW,MADZ;AAEjBR,UAAAA,SAAS,EAAEA;AAFM,SAAf;AANO,OAAZ,CAAL,CAUGS,IAVH,CAUQC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAVf,EAWCF,IAXD,CAWMG,GAAG,IAAI,KAAKC,QAAL,CAAc;AAACD,QAAAA,GAAG,EAAEA,GAAN;AAAWE,QAAAA,QAAQ,EAAEC,IAAI,CAACC,KAAL,CAAWJ,GAAG,CAACK,MAAJ,GAAW,KAAKhB,KAAL,CAAWiB,UAAtB,GAAmC,IAA9C;AAArB,OAAd,CAXb,EAYCC,KAZD,CAYOC,CAAC,IAAIC,OAAO,CAACC,KAAR,CAAc,uBAAuBF,CAAC,CAACG,OAAvC,CAZZ;AAaH,KA/Ce;;AAAA,SAiDhBC,cAjDgB,GAiDExB,SAAD,IAAe;AAC5B,WAAKa,QAAL,CAAc;AAACb,QAAAA;AAAD,OAAd,EAA2B,MAAM,KAAKD,MAAL,EAAjC;AACH,KAnDe;;AAAA,SAqDhB0B,qBArDgB,GAqDSL,CAAD,IAAO;AAC3B;AACA;AACA;AACA;AACA,YAAMM,QAAQ,GAAGC,MAAM,CAACD,QAAP,CAAgBE,IAAjC;AACA,UAAIC,OAAO,GAAG,CAAd;;AACA,cAAOT,CAAC,CAACU,MAAF,CAASC,EAAhB;AACI,aAAK,OAAL;AACI,eAAKlB,QAAL,CAAc;AAACmB,YAAAA,IAAI,EAAE;AAAP,WAAd,EADJ,CAEI;;AACAL,UAAAA,MAAM,CAACM,OAAP,CAAeC,YAAf,CAA4B,IAA5B,EAAkC,EAAlC,EAAsCR,QAAQ,GAAG,GAAjD;AACA;;AACJ,aAAK,UAAL;AACI,eAAKzB,KAAL,CAAW+B,IAAX,GAAkB,CAAlB,GAAsBH,OAAO,GAAG,KAAK5B,KAAL,CAAW+B,IAAX,GAAgB,CAAhD,GAAoDH,OAAO,GAAG,CAA9D;AACA,eAAKhB,QAAL,CAAc;AAACmB,YAAAA,IAAI,EAAEH;AAAP,WAAd,EAFJ,CAGI;;AACAF,UAAAA,MAAM,CAACM,OAAP,CAAeC,YAAf,CAA4B,IAA5B,EAAkC,EAAlC,EAAsCR,QAAQ,GAAGG,OAAjD;AACA;;AACJ,aAAK,MAAL;AACI,eAAK5B,KAAL,CAAW+B,IAAX,GAAkB,KAAK/B,KAAL,CAAWa,QAA7B,GAAwCe,OAAO,GAAG,KAAK5B,KAAL,CAAW+B,IAAX,GAAgB,CAAlE,GAAsEH,OAAO,GAAG,KAAK5B,KAAL,CAAWa,QAA3F;AACA,eAAKD,QAAL,CAAc;AAACmB,YAAAA,IAAI,EAAEH;AAAP,WAAd,EAFJ,CAGI;;AACAF,UAAAA,MAAM,CAACM,OAAP,CAAeC,YAAf,CAA4B,IAA5B,EAAkC,EAAlC,EAAsCR,QAAQ,GAAGG,OAAjD;AACA;;AACJ,aAAK,MAAL;AACI,eAAKhB,QAAL,CAAc;AAACmB,YAAAA,IAAI,EAAE,KAAK/B,KAAL,CAAWa;AAAlB,WAAd,EADJ,CAEI;;AACAa,UAAAA,MAAM,CAACM,OAAP,CAAeC,YAAf,CAA4B,IAA5B,EAAkC,EAAlC,EAAsCR,QAAQ,GAAG,KAAKzB,KAAL,CAAWa,QAA5D;AACA;;AACJ;AACI,iBAAO,IAAP;AAxBR;AA0BH,KAtFe;;AAAA,SAwFhBqB,QAxFgB,GAwFJvB,GAAD,IAAS;AAEhB,YAAMwB,QAAQ,GAAG;AACbC,QAAAA,KAAK,EAAE,MADM;AAEbC,QAAAA,MAAM,EAAE;AAFK,OAAjB;AAKA,YAAMC,OAAO,GAAG;AACZC,QAAAA,OAAO,EAAE,MADG;AAEZC,QAAAA,mBAAmB,EAAE,gBAFT;AAGZC,QAAAA,OAAO,EAAE,aAHG;AAIZC,QAAAA,QAAQ,EAAE,MAJE;AAKZC,QAAAA,MAAM,EAAE;AALI,OAAhB;AAQA,UAAI5C,SAAS,GAAG,KAAKC,KAAL,CAAWD,SAA3B;;AACA,UAAIY,GAAG,CAACK,MAAJ,KAAe,CAAnB,EAAsB;AAClB,4BAAO;AAAK,UAAA,KAAK,EAAE;AAACuB,YAAAA,OAAO,EAAE,MAAV;AAAkBG,YAAAA,QAAQ,EAAE,MAA5B;AAAoCE,YAAAA,SAAS,EAAE,MAA/C;AAAuDC,YAAAA,cAAc,EAAE;AAAvE,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACK;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBAAK;AAAI,UAAA,KAAK,EAAI;AAACC,YAAAA,KAAK,EAAE;AAAR,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uDAAL,CADL,CAAP;AAGH,OAJD,MAKK;AACD,4BAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACK;AAAG,UAAA,SAAS,EAAG,YAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kDAAkD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WAAI/C,SAAJ,CAAlD,CADL,eAEK;AAAK,UAAA,KAAK,EAAE;AAAC2C,YAAAA,QAAQ,EAAE,MAAX;AAAmBG,YAAAA,cAAc,EAAE,QAAnC;AAA6CD,YAAAA,SAAS,EAAC;AAAvD,WAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,wBACI;AAAK,UAAA,KAAK,EAAEN,OAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACK3B,GAAG,CAACoC,GAAJ,CAASC,EAAD,IAAQ;AACb,cAAIC,QAAQ,GAAG1D,SAAS,CAAC2D,aAAV,CAAwBF,EAAE,CAACC,QAA3B,CAAf;AACA,cAAIE,WAAJ;;AACA,kBAAOF,QAAP;AACI,iBAAK,OAAL;AACIE,cAAAA,WAAW,GAAG5D,SAAS,CAAC6D,KAAV,CAAgBJ,EAAE,CAACG,WAAnB,EAAgCE,KAA9C;AACA;;AACJ,iBAAK,KAAL;AACIF,cAAAA,WAAW,GAAG5D,SAAS,CAAC+D,GAAV,CAAcN,EAAE,CAACG,WAAjB,EAA8BE,KAA5C;AACA;;AACJ,iBAAK,MAAL;AACIF,cAAAA,WAAW,GAAG5D,SAAS,CAACgE,IAAV,CAAeP,EAAE,CAACG,WAAlB,EAA+BE,KAA7C;AACA;;AACJ;AACIF,cAAAA,WAAW,GAAG,CAAd;AAXR;;AAaA,8BACI;AAAI,YAAA,GAAG,EAAEH,EAAE,CAACQ,KAAZ;AAAmB,YAAA,KAAK,EAAE;AAAEC,cAAAA,aAAa,EAAE;AAAjB,aAA1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAAqD,oBAAC,OAAD;AAAS,YAAA,KAAK,MAAd;AAAe,YAAA,EAAE,EACrE,eAAeR,QAAf,GAA0B,GAA1B,GAAgCE,WAAhC,GAA8C,QAA9C,GAAyDH,EAAE,CAACQ,KADR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAEjD;AAAK,YAAA,GAAG,EAAE,MAAMR,EAAE,CAACU,UAAnB;AAA+B,YAAA,GAAG,EAAIV,EAAE,CAACQ,KAAH,GAAW,WAAjD;AAA8D,YAAA,KAAK,EAAErB,QAArE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFiD,CAArD,CADJ;AAMC,SAtBJ,CADL,CADJ,CAFL,CAAP;AA+BH;AAEJ,KA/Ie;;AAElB,SAAKnC,KAAL,GAAa;AACHD,MAAAA,SAAS,EAAE,EADR;AAEH4D,MAAAA,YAAY,EAAE,CAFX;AAGHhD,MAAAA,GAAG,EAAE,EAHF;AAIHM,MAAAA,UAAU,EAAE,CAJT;AAKHJ,MAAAA,QAAQ,EAAE,CALP;AAMHkB,MAAAA,IAAI,EAAE;AANH,KAAb;AAQG;;AAGJ6B,EAAAA,iBAAiB,GAAG;AACb,aAASC,gBAAT,CAA0BC,GAA1B,EAA+BC,IAA/B,EAAqC;AACjC,aAAOD,GAAG,CAACE,SAAJ,CAAcF,GAAG,CAACG,OAAJ,CAAYF,IAAZ,IAAoB,CAAlC,CAAP;AACH;;AACD,aAASG,kBAAT,CAA4BJ,GAA5B,EAAiCK,KAAjC,EAAwCC,KAAxC,EAA+C;AAC3C,aAAON,GAAG,CAACE,SAAJ,CAAcF,GAAG,CAACG,OAAJ,CAAYE,KAAZ,IAAqB,CAAnC,EAAsCL,GAAG,CAACG,OAAJ,CAAYG,KAAZ,IAAmB,CAAzD,CAAP;AACH;;AACD,UAAMrE,SAAS,GAAG8D,gBAAgB,CAACnC,MAAM,CAACD,QAAP,CAAgBE,IAAjB,EAAuB,GAAvB,EAA4B,GAA5B,CAAlC;AACAP,IAAAA,OAAO,CAACiD,GAAR,CAAYtE,SAAZ;AACA,SAAKa,QAAL,CAAc;AAAC+C,MAAAA,YAAY,EAAE5D,SAAS,CAACiB;AAAzB,KAAd;AACA,UAAMe,IAAI,GAAG8B,gBAAgB,CAACnC,MAAM,CAACD,QAAP,CAAgBE,IAAjB,EAAuB,MAAM5B,SAAS,CAACiB,MAAvC,CAA7B;AACA,SAAKJ,QAAL,CAAc;AAACb,MAAAA,SAAD;AAAYgC,MAAAA;AAAZ,KAAd,EAAiC,MAAM,KAAKjC,MAAL,EAAvC;AACH;;AAEDwE,EAAAA,oBAAoB,GAAG;AACnB,SAAK1E,eAAL,CAAqB2E,KAArB;AACH;;AAoHDC,EAAAA,MAAM,GAAG;AACL,UAAMC,IAAI,GAAG,gBAAb;AAEA,QAAIC,MAAM,GAAG,KAAK1E,KAAL,CAAWW,GAAX,CAAeK,MAA5B;AACA,QAAI2D,CAAC,GAAG,KAAK3E,KAAL,CAAWiB,UAAnB;AACA,QAAI2D,CAAC,GAAG,KAAK5E,KAAL,CAAW+B,IAAX,GAAkB,CAA1B;AACA,QAAI8C,IAAJ;AACAD,IAAAA,CAAC,GAACD,CAAF,GAAMA,CAAN,GAAUD,MAAV,GAAmBG,IAAI,GAAG,CAACD,CAAC,GAAC,CAAH,IAAMD,CAAhC,GAAoCE,IAAI,GAAGH,MAA3C;AACA,QAAII,UAAU,GAAG,KAAK9E,KAAL,CAAWW,GAAX,CAAeoE,KAAf,CAAqBH,CAAC,GAACD,CAAvB,EAA0BE,IAA1B,CAAjB;AAEA,wBACY;AAAK,MAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,eAEK,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFL,eAGK,oBAAC,MAAD;AAAQ,MAAA,cAAc,EAAI,KAAKtD,cAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAHL,eAIK,oBAAC,WAAD;AAAa,MAAA,QAAQ,EAAIkD,IAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJL,EAKS,KAAKvC,QAAL,CAAc4C,UAAd,CALT,eAMI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAQ,MAAA,EAAE,EAAC,OAAX;AAAmB,MAAA,SAAS,EAAC,WAA7B;AAAyC,MAAA,OAAO,EAAE,KAAKtD,qBAAvD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADJ,eAEI;AAAQ,MAAA,EAAE,EAAC,UAAX;AAAsB,MAAA,SAAS,EAAC,WAAhC;AAA4C,MAAA,OAAO,EAAE,KAAKA,qBAA1D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAFJ,eAGI;AAAQ,MAAA,EAAE,EAAC,SAAX;AAAqB,MAAA,SAAS,EAAC,WAA/B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAA4C,KAAKxB,KAAL,CAAW+B,IAAvD,OAA8D,KAAK/B,KAAL,CAAWa,QAAzE,CAHJ,eAII;AAAQ,MAAA,EAAE,EAAC,MAAX;AAAkB,MAAA,SAAS,EAAC,WAA5B;AAAwC,MAAA,OAAO,EAAE,KAAKW,qBAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAJJ,eAKI;AAAQ,MAAA,EAAE,EAAC,MAAX;AAAkB,MAAA,SAAS,EAAC,WAA5B;AAAwC,MAAA,OAAO,EAAE,KAAKA,qBAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBALJ,CANJ,eAaI,oBAAC,OAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAbJ,eAcK,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAdL,CADZ;AAkBH;;AA/KuC;;AAmL5C,eAAehC,aAAf","sourcesContent":["import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport * as Constants from '../../constants';\n\n\nclass SearchResults extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            searchFor: '',\n            searchForLen: 0,\n            ads: [],\n            adsPerPage: 5,\n            numPages: 1,\n            page: 1 \n        };\n    }\n    \n    abortController = new AbortController();\n\tcomponentDidMount() {\n        function subStrAfterChars(str, char) {\n            return str.substring(str.indexOf(char) + 1);\n        }\n        function subStrBetweenChars(str, char1, char2) {\n            return str.substring(str.indexOf(char1) + 1, str.indexOf(char2)+1);\n        }\n        const searchFor = subStrAfterChars(window.location.href, '?', '=');\n        console.log(searchFor);\n        this.setState({searchForLen: searchFor.length});\n        const page = subStrAfterChars(window.location.href, '?' + searchFor.length);\n        this.setState({searchFor, page}, () => this.search());\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    search = () => {\n        let searchFor = this.state.searchFor;\n        if (searchFor === '') searchFor = 'nothingtosearchfor';\n        fetch('/search', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                signal: this.abortController.signal,\n                searchFor: searchFor\n            })\n        }).then(res => res.json())\n        .then(ads => this.setState({ads: ads, numPages: Math.floor(ads.length/this.state.adsPerPage + 0.99)}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    onSearchChange = (searchFor) => {\n        this.setState({searchFor}, () => this.search());\n    }\n\n    paginationButtonClick = (e) => {\n        // function subStrBeforeChars(str, char) {\n        //     return str.substring(0, str.indexOf(char));\n        // }\n        // const location = subStrBeforeChars(window.location.href, '?');\n        const location = window.location.href;\n        let newpage = 1;\n        switch(e.target.id) {\n            case 'first':\n                this.setState({page: 1});\n                //window.history.replaceState(null, \"\", location + '?1');\n                window.history.replaceState(null, \"\", location + '1');\n                break;\n            case 'previous':\n                this.state.page > 1 ? newpage = this.state.page-1 : newpage = 1;\n                this.setState({page: newpage});\n                //window.history.replaceState(null, \"\", location + '?' + newpage);\n                window.history.replaceState(null, \"\", location + newpage);\n                break;\n            case 'next':\n                this.state.page < this.state.numPages ? newpage = this.state.page+1 : newpage = this.state.numPages;\n                this.setState({page: newpage});\n                //window.history.replaceState(null, \"\", location + '?' + newpage);\n                window.history.replaceState(null, \"\", location + newpage);\n                break;\n            case 'last':\n                this.setState({page: this.state.numPages});\n                //window.history.replaceState(null, \"\", location + '?' + this.state.numPages);\n                window.history.replaceState(null, \"\", location + this.state.numPages);\n                break;\n            default:\n                return null;\n        }\n    }\n\n    toRender = (ads) => {\n\n        const imgStyle = {\n            width: \"100%\",\n            border: '2px solid white'\n        }\n    \n        const wrapper = {\n            display: \"grid\",\n            gridTemplateColumns: \"repeat(4, 1fr)\",\n            gridGap: \"100px 100px\",\n            maxWidth: \"100%\",\n            margin: \"50px 50px\"\n        }\n\n        let searchFor = this.state.searchFor;\n        if (ads.length === 0) {\n            return <div style={{display: \"flex\", maxWidth: \"90vw\", minHeight: '30vh', justifyContent: 'center'}}>\n                        <div><h2 style = {{color: 'white'}}>OPROSTITE, NIČESAR NISMO NAŠLI!</h2></div>\n                    </div>\n        }\n        else {\n            return <div>\n                        <p className = 'white-back'>Rezultati iskanja za: <b>{searchFor}</b></p>\n                        <div style={{maxWidth: '100%', justifyContent: 'center', minHeight:'80vh'}}>\n                            <div style={wrapper}>\n                                {ads.map((ad) => {\n                                    let category = Constants.categoryNames[ad.category]\n                                    let subcategory;\n                                    switch(category) {\n                                        case 'women':\n                                            subcategory = Constants.women[ad.subcategory].value;\n                                            break;\n                                        case 'men':\n                                            subcategory = Constants.men[ad.subcategory].value;\n                                            break;\n                                        case 'kids':\n                                            subcategory = Constants.kids[ad.subcategory].value;\n                                            break;\n                                        default:\n                                            subcategory = 0;\n                                    }\n                                    return (\n                                        <li key={ad.ad_id} style={{ listStyleType: \"none\" }}><NavLink exact to =\n                                        {'/listings/' + category + '/' + subcategory + '/item?' + ad.ad_id}>\n                                            <img src={'/' + ad.photo1_url} alt = {ad.ad_id + 'somephoto'} style={imgStyle}/>\n                                        </NavLink></li>)\n                \n                                    }\n                                )}\n                            </div>\n                        </div>\n                    </div>\n        }\n\n    }\n\n    render() {\n        const path = '/searchresults';\n\n        let numAds = this.state.ads.length;\n        let n = this.state.adsPerPage;\n        let p = this.state.page - 1;\n        let till;\n        p*n + n < numAds ? till = (p+1)*n : till = numAds;\n        let adsPortion = this.state.ads.slice(p*n, till);\n\n        return (\n                    <div className=\"App\">\n                        <UpperLine/>\n                         <Header/>\n                         <NavBar callBackParent = {this.onSearchChange}/>\n                         <BreadCrumbs pathname = {path}/>\n                            {this.toRender(adsPortion)}\n                        <div>\n                            <button id='first' className='btn_nopad' onClick={this.paginationButtonClick}>PRVA</button>\n                            <button id='previous' className='btn_nopad' onClick={this.paginationButtonClick}>&#60;&#60;</button>\n                            <button id='current' className='btn_nopad'>{this.state.page}/{this.state.numPages}</button>\n                            <button id='next' className='btn_nopad' onClick={this.paginationButtonClick}>&#62;&#62;</button>\n                            <button id='last' className='btn_nopad' onClick={this.paginationButtonClick}>ZADNJA</button>\n                        </div>\n                        <AdSpace/>\n                         <Bottom/>\n                     </div>\n        )\n    }\n\n}\n  \nexport default SearchResults;"]},"metadata":{},"sourceType":"module"}