{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/ShoppingCart/ShoppingCartPage.jsx\";\nimport React from 'react';\nimport '../../App.css';\nimport { connect } from 'react-redux';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport Bottom from '../../components/Bottom';\nimport CartGroup from './CartGroup';\nimport BreadCrumbs from '../../components/BreadCrumbs';\n\nclass ShoppingCartPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.getCart = () => {\n      fetch('/sessionroutes', {\n        signal: this.abortController.signal\n      }).then(res => res.json()).then(res => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n\n        if (cart) {\n          cart.length && fetch('/cartListings', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json'\n            },\n            body: JSON.stringify(cart)\n          }).then(res => res.json()).then(res => {\n            this.setState({\n              sortedCart: res\n            }, () => {\n              res.length !== cart.length && this.deleteFromStorage(res);\n            });\n          }).catch(e => console.error(\"Critical failure: \" + e.message));\n          !cart.length && this.setState({\n            sortedCart: []\n          });\n        }\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.reMount = () => {\n      this.getCart();\n    };\n\n    this.deleteFromStorage = items => {\n      fetch('/sessionroutes', {\n        signal: this.abortController.signal\n      }).then(res => res.json()).then(res => {\n        this.removeFromCart(res, items);\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.removeFromCart = (res, items) => {\n      let cart = JSON.parse(window.localStorage.getItem(res.userId));\n\n      for (let i = 0; i < cart.length; i++) {\n        let d = 0;\n\n        for (let j = 0; j < items.length; j++) {\n          if (cart[i] == items[j].ad_id.toString()) d = 1;\n        }\n\n        if (d == 0) {\n          if (cart !== null) {\n            window.localStorage.setItem(res.userId, JSON.stringify(cart));\n          }\n        }\n      }\n    };\n\n    this.listCart = () => {\n      const sCart = this.state.sortedCart;\n      let componentArray = [];\n      let sellerArray = [];\n      let listingArray = [];\n\n      if (sCart.length > 0) {\n        let seller;\n        let weight;\n        let i = 0;\n        let j = 0;\n\n        while (i < sCart.length) {\n          seller = sCart[i].username;\n          weight = 0;\n\n          while (j < sCart.length && sCart[j].username === seller) {\n            listingArray.push(sCart[j]);\n            j++;\n          }\n\n          sellerArray.push(listingArray);\n          componentArray.push( /*#__PURE__*/React.createElement(CartGroup, {\n            key: j,\n            items: listingArray,\n            loggedInUserId: this.props.loggedInUserId,\n            callBackParent: this.reMount,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 102,\n              columnNumber: 37\n            }\n          }));\n          listingArray = [];\n          i = j;\n        }\n      }\n\n      return componentArray;\n    };\n\n    this.showCart = () => {\n      console.log(JSON.parse(window.localStorage.getItem(this.props.loggedInUserId)));\n      console.log(this.state.sortedCart);\n      console.log(this.state.cart);\n    };\n\n    this.state = {\n      cart: [],\n      sortedCart: []\n    };\n  }\n\n  componentDidMount() {\n    this.getCart();\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    let len = this.state.sortedCart.length;\n\n    if (!len) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"App\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(UpperLine, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(NavBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n        pathname: this.props.location.pathname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundColor: 'rgb(255,255,255,0.5)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 30\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 132,\n          columnNumber: 35\n        }\n      }), /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 25\n        }\n      }, \"SHOPPING CART IS EMPTY!\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 30\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 35\n        }\n      })), /*#__PURE__*/React.createElement(Bottom, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 21\n        }\n      }));\n    } else return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        padding: '30px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }\n    }, this.listCart()), /*#__PURE__*/React.createElement(\"button\", {\n      onClick: this.showCart,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 17\n      }\n    }, \"CART\"), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nexport default connect(mapStateToProps)(ShoppingCartPage);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/ShoppingCart/ShoppingCartPage.jsx"],"names":["React","connect","UpperLine","Header","NavBar","Bottom","CartGroup","BreadCrumbs","ShoppingCartPage","Component","constructor","props","abortController","AbortController","getCart","fetch","signal","then","res","json","cart","JSON","parse","window","localStorage","getItem","userId","length","method","headers","body","stringify","setState","sortedCart","deleteFromStorage","catch","e","console","error","message","reMount","items","removeFromCart","i","d","j","ad_id","toString","setItem","listCart","sCart","state","componentArray","sellerArray","listingArray","seller","weight","username","push","loggedInUserId","showCart","log","componentDidMount","componentWillUnmount","abort","render","len","location","pathname","backgroundColor","padding","mapStateToProps","loggedInUser"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../App.css';\nimport { connect } from 'react-redux';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport Bottom from '../../components/Bottom';\nimport CartGroup from './CartGroup';\nimport BreadCrumbs from '../../components/BreadCrumbs';\n\n\nclass ShoppingCartPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n                cart: [],\n                sortedCart: []\n        };\n\n    }\n    abortController = new AbortController();\n\n    //zaenkrat ta komponenta ne potrebuje connecta na redux ker sem morala klicati userja iz baze:\n\n    getCart = () => {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {let cart = JSON.parse(window.localStorage.getItem(res.userId));\n            if(cart) {\n                (cart.length) && fetch('/cartListings', {\n                    signal: this.abortController.signal,\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Accept': 'application/json'\n                    },\n                    body: JSON.stringify(cart)\n                }).then(res => res.json())\n                    .then(res => {this.setState({sortedCart: res}, () => {res.length !== cart.length && this.deleteFromStorage(res);})})\n                    .catch(e => console.error(\"Critical failure: \" + e.message));\n\n                (!cart.length) && this.setState({sortedCart: []});\n            }\n        })\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentDidMount() {\n        this.getCart();\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    reMount = () => {\n        this.getCart();\n    }\n\n    deleteFromStorage = (items) => {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {this.removeFromCart(res, items);})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    removeFromCart = (res, items) => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n        for (let i = 0; i < cart.length; i++) {\n            let d = 0;\n            for (let j = 0; j < items.length; j++) {\n                if (cart[i] == items[j].ad_id.toString()) d = 1;\n            }\n            if (d == 0) {\n                if (cart !== null) {\n                    window.localStorage.setItem(res.userId, JSON.stringify(cart));\n                }\n            }\n        }\n    }\n\n    listCart = () => {\n        const sCart = this.state.sortedCart;\n        let componentArray = [];\n        let sellerArray = [];\n        let listingArray = [];\n\n        if (sCart.length > 0) {\n            let seller;\n            let weight;\n\n            let i = 0; let j = 0;\n            while (i < sCart.length) {\n                seller = sCart[i].username;\n                weight = 0;\n                while (j < sCart.length && sCart[j].username === seller) {\n                    listingArray.push(sCart[j]);\n                    j++;\n                }\n                sellerArray.push(listingArray);\n                componentArray.push(<CartGroup\n                                        key={j}\n                                        items = {listingArray}\n                                        loggedInUserId = {this.props.loggedInUserId}\n                                        callBackParent = {this.reMount}/>);\n                listingArray = [];\n                i = j;\n            }\n        }   \n        return componentArray;\n    }\n\n    showCart = () => {\n        console.log(JSON.parse(window.localStorage.getItem(this.props.loggedInUserId)));\n        console.log(this.state.sortedCart);\n        console.log(this.state.cart);\n    }\n\n    render() {\n\n        let len = this.state.sortedCart.length;\n\n        if (!len) {\n            return (\n                <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                        <br/><br/><br/>\n                        <h2>SHOPPING CART IS EMPTY!</h2>\n                        <br/><br/><br/>\n                    </div>\n                    <Bottom/>\n                </div>\n                )\n        }\n        else return (\n            <div className=\"App\">\n                <UpperLine/>\n                <Header/>\n                <NavBar/>\n                <BreadCrumbs pathname = {this.props.location.pathname}/>\n                <div style = {{padding: '30px'}}>\n                    {this.listCart()}\n                </div>\n                <button onClick = {this.showCart}>CART</button>\n                <Bottom/>\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId,\n    };\n};\n\nexport default connect(mapStateToProps) (ShoppingCartPage);\n"]},"metadata":{},"sourceType":"module"}