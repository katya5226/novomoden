{"ast":null,"code":"import _classCallCheck from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{NavLink}from'react-router-dom';import{connect}from'react-redux';import{logIn,logOut}from'../../redux/actions';import UpperLine from'../../components/UpperLine';import Header from'../../components/Header';import Bottom from'../../components/Bottom';import BreadCrumbs from'../../components/BreadCrumbs';import NavBar from'../../components/NavBar';import AdSpace from'../../components/AdSpace';var PaymentStatus=/*#__PURE__*/function(_React$Component){_inherits(PaymentStatus,_React$Component);var _super=_createSuper(PaymentStatus);function PaymentStatus(props){var _this;_classCallCheck(this,PaymentStatus);_this=_super.call(this,props);_this.abortController=new AbortController();_this.timer=null;_this.checkPayment=function(){function subStrAfterChars(str,char){return str.substring(str.indexOf(char)+1);}var eventId=subStrAfterChars(window.location.href,'=');fetch('/paymentstatus',{signal:_this.abortController.signal,method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({eventId:eventId})}).then(function(res){return res.json();}).then(function(res){if(res.success){_this.setState({success:true,eventId:res.orderId});}}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});};_this.switchRender=function(){if(_this.state.success){return/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'rgb(255,255,255,0.7)',margin:'0 auto'}},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h1\",null,\"PLA\\u010CILO JE SPREJETO! NARO\\u010CILO ZAKLJU\\u010CENO! \\u0160TEVILKA NARO\\u010CILA: \",_this.state.eventId),/*#__PURE__*/React.createElement(NavLink,{exact:true,to:\"/\",className:\"btnb\"},\"DOMOV\"),/*#__PURE__*/React.createElement(\"br\",null));}else{return/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'rgb(255,255,255,0.7)',margin:'0 auto'}},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h1\",null,\"OJEJ, NEKAJ JE \\u0160LO NAROBE, PLA\\u010CILO NI USPELO.\"),/*#__PURE__*/React.createElement(NavLink,{exact:true,to:\"/\",className:\"btnb\"},\"DOMOV\"),/*#__PURE__*/React.createElement(\"br\",null));}};_this.state={success:false,eventId:''};return _this;}_createClass(PaymentStatus,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;this.timer=setTimeout(function(){return _this2.checkPayment();},100);//this.interval = setInterval(() => {this.checkPayment();}, 3000);\n}},{key:\"componentWillUnmount\",//{if (res.success) {this.setState({success: true, eventId: eventId})}}\nvalue:function componentWillUnmount(){this.abortController.abort();clearTimeout(this.timer);//clearInterval(this.interval);\n}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(UpperLine,null),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(BreadCrumbs,{pathname:this.props.location.pathname}),this.switchRender(),/*#__PURE__*/React.createElement(AdSpace,null),/*#__PURE__*/React.createElement(Bottom,null));}}]);return PaymentStatus;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{loggedInUser:state.loggedInUser,loggedInUserId:state.loggedInUserId};};var mapDispatchToProps={logIn:logIn,logOut:logOut};export default connect(mapStateToProps,mapDispatchToProps)(PaymentStatus);","map":{"version":3,"sources":["/home/katni/APP/client/src/pages/ShoppingCart/PaymentStatus.jsx"],"names":["React","NavLink","connect","logIn","logOut","UpperLine","Header","Bottom","BreadCrumbs","NavBar","AdSpace","PaymentStatus","props","abortController","AbortController","timer","checkPayment","subStrAfterChars","str","char","substring","indexOf","eventId","window","location","href","fetch","signal","method","headers","body","JSON","stringify","then","res","json","success","setState","orderId","catch","e","console","error","message","switchRender","state","backgroundColor","margin","setTimeout","abort","clearTimeout","pathname","Component","mapStateToProps","loggedInUser","loggedInUserId","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\n\n\nclass PaymentStatus extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            success: false,\n            eventId: ''\n        };\n    }\n\n    abortController = new AbortController();\n    timer = null;\n\n    componentDidMount() {\n        this.timer = setTimeout(() => this.checkPayment(), 100);\n        //this.interval = setInterval(() => {this.checkPayment();}, 3000);\n    }\n\n    checkPayment = () => {\n        function subStrAfterChars(str, char) {\n            return str.substring(str.indexOf(char) + 1);\n        }\n        const eventId = subStrAfterChars(window.location.href, '=');\n        fetch('/paymentstatus', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                eventId: eventId\n            })\n        }).then(res => res.json())\n        .then(res =>{if (res.success) {this.setState({success: true, eventId: res.orderId})}})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    //{if (res.success) {this.setState({success: true, eventId: eventId})}}\n\n    componentWillUnmount() {\n        this.abortController.abort();\n        clearTimeout(this.timer);\n        //clearInterval(this.interval);\n    }\n\n    switchRender = () => {\n\n        if (this.state.success) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>PLAČILO JE SPREJETO! NAROČILO ZAKLJUČENO! ŠTEVILKA NAROČILA: {this.state.eventId}</h1>\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        } else {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>OJEJ, NEKAJ JE ŠLO NAROBE, PLAČILO NI USPELO.</h1>\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        }\n    }\n\n    render() {\n        return <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    {this.switchRender()}\n                    <AdSpace/>\n                    <Bottom/>\n                </div>\n  \n    }\n    \n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n  \n  const mapDispatchToProps = {\n    logIn: logIn,\n    logOut: logOut\n  };\n\nexport default connect(mapStateToProps, mapDispatchToProps) (PaymentStatus);\n"]},"metadata":{},"sourceType":"module"}