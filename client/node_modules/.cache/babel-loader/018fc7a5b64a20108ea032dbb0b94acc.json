{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/components/UpperLine.jsx\";\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../redux/actions';\n\nclass UpperLine extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.removeFromCart = (res, items) => {\n      let cart = JSON.parse(window.localStorage.getItem(res.userId));\n\n      for (let i = 0; i < cart.length; i++) {\n        let d = 0;\n\n        for (let j = 0; j < items.length; j++) {\n          if (cart[i] === items[j].ad_id.toString()) d = 1;\n        }\n\n        if (d === 0) {\n          cart.splice(cart.indexOf(cart[i]), 1);\n          window.localStorage.setItem(res.userId, JSON.stringify(cart));\n        }\n      }\n    };\n\n    this.deleteFromStorage = items => {\n      fetch('/sessionroutes', {\n        signal: this.abortController.signal\n      }).then(res => res.json()).then(res => {\n        this.removeFromCart(res, items);\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.goHome = () => {\n      window.location.href = '/';\n    };\n\n    this.state = {\n      cartNum: 0,\n      unreadMsg: 0\n    };\n    this.handleClickLogOut = this.handleClickLogOut.bind(this);\n  }\n\n  componentDidMount() {\n    fetch('/sessionroutes', {\n      signal: this.abortController.signal\n    }).then(res => res.json()).then(res => {\n      if (res.userId !== '0') {\n        this.props.logIn(res.loggedInUser, res.userId);\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n\n        if (cart) {\n          //this.setState({cartNum: cart.length})\n          cart.length && fetch('/cartListings', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json'\n            },\n            body: JSON.stringify(cart)\n          }).then(res => res.json()).then(res => {\n            this.setState({\n              cartNum: res.length\n            }, () => {\n              res.length !== cart.length && this.deleteFromStorage(res);\n            });\n          }).catch(e => console.error(\"Critical failure: \" + e.message));\n        }\n\n        fetch('/messageroutes', {\n          signal: this.abortController.signal,\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Accept': 'application/json'\n          },\n          body: JSON.stringify({\n            type: 5\n          })\n        }).then(res => res.json()).then(res => this.setState({\n          unreadMsg: res\n        })).catch(e => console.error(\"Critical failure: \" + e.message));\n      }\n    }).catch(e => console.error(\"Critical failure: \" + e.message));\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  handleClickLogOut() {\n    window.location.href = '/';\n    fetch('/loginroutes', {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        type: \"logout\"\n      })\n    }).then(res => res.json()).then(res => this.props.logIn(res.loggedInUser, res.userId)).then(() => this.goHome()).catch(e => console.error(\"Critical failure: \" + e.message));\n  }\n\n  render() {\n    let cartNum = this.state.cartNum;\n    let unreadMsg = this.state.unreadMsg;\n    const linkStyle = {\n      textDecoration: 'none',\n      color: 'black'\n    };\n    const userBtnStyle = {\n      color: 'white',\n      textShadow: '1px 1px black',\n      backgroundColor: 'rgb(255, 255, 255, 0)',\n      padding: 0,\n      border: 'none'\n    };\n    const logoutStyle = {\n      color: 'white',\n      textShadow: '1px 1px black',\n      backgroundColor: 'rgb(255, 255, 255, 0)',\n      paddinRight: 10,\n      border: 'none',\n      textDecoration: 'underline',\n      cursor: 'pointer'\n    };\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"Upper-line\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 13\n      }\n    }, this.props.loggedInUser === 'guest' ? /*#__PURE__*/React.createElement(\"button\", {\n      className: \"btn\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 56\n      }\n    }, /*#__PURE__*/React.createElement(NavLink, {\n      exact: true,\n      to: \"/login_page\",\n      className: \"first\",\n      style: linkStyle,\n      activeStyle: {\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 21\n      }\n    }, \"PRIJAVA\")) : /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"button\", {\n      style: userBtnStyle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 21\n      }\n    }, \"\\u017Divjo \", this.props.loggedInUser, \"! \"), /*#__PURE__*/React.createElement(\"button\", {\n      style: logoutStyle,\n      onClick: this.handleClickLogOut,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 21\n      }\n    }, \" (odjava)\"), /*#__PURE__*/React.createElement(NavLink, {\n      exact: true,\n      to: \"/user_listings\",\n      className: ['btn', 'first'].join(' '),\n      style: linkStyle,\n      activeStyle: {\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 21\n      }\n    }, \"MOJA STRAN\"), /*#__PURE__*/React.createElement(NavLink, {\n      exact: true,\n      to: \"/chatpage\",\n      className: ['btn', 'first'].join(' '),\n      style: linkStyle,\n      activeStyle: {\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 21\n      }\n    }, !unreadMsg ? 'SPOROČILA' : 'SPOROČILA (' + unreadMsg + ')'), /*#__PURE__*/React.createElement(NavLink, {\n      exact: true,\n      to: \"/shoppingcart\",\n      className: ['btn', 'first'].join(' '),\n      style: linkStyle,\n      activeStyle: {\n        fontWeight: \"bold\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 21\n      }\n    }, !cartNum ? 'KOŠARICA' : 'KOŠARICA (' + cartNum + ')')));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nconst mapDispatchToProps = {\n  logIn: logIn,\n  logOut: logOut\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(UpperLine);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/components/UpperLine.jsx"],"names":["React","NavLink","connect","logIn","logOut","UpperLine","Component","constructor","props","abortController","AbortController","removeFromCart","res","items","cart","JSON","parse","window","localStorage","getItem","userId","i","length","d","j","ad_id","toString","splice","indexOf","setItem","stringify","deleteFromStorage","fetch","signal","then","json","catch","e","console","error","message","goHome","location","href","state","cartNum","unreadMsg","handleClickLogOut","bind","componentDidMount","loggedInUser","method","headers","body","setState","type","componentWillUnmount","abort","render","linkStyle","textDecoration","color","userBtnStyle","textShadow","backgroundColor","padding","border","logoutStyle","paddinRight","cursor","fontWeight","join","mapStateToProps","loggedInUserId","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { NavLink} from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../redux/actions';\n\nclass UpperLine extends React.Component {\n\n\tconstructor(props) {\n        super(props);\n        this.state = {\n            cartNum: 0,\n            unreadMsg: 0\n        };\n        this.handleClickLogOut = this.handleClickLogOut.bind(this);\n    }\n\n    abortController = new AbortController();\n\tcomponentDidMount() {\n\t\tfetch('/sessionroutes', {signal: this.abortController.signal})\n\t\t\t.then(res => res.json())\n            .then(res => {if(res.userId !== '0') {\n                            this.props.logIn(res.loggedInUser, res.userId);\n                            let cart = JSON.parse(window.localStorage.getItem(res.userId));\n                            if(cart) {\n                                //this.setState({cartNum: cart.length})\n                                (cart.length) && fetch('/cartListings', {\n                                    signal: this.abortController.signal,\n                                    method: 'POST',\n                                    headers: {\n                                        'Content-Type': 'application/json',\n                                        'Accept': 'application/json'\n                                    },\n                                    body: JSON.stringify(cart)\n                                }).then(res => res.json())\n                                    .then(res => {this.setState({cartNum: res.length}, () => {(res.length !== cart.length) && this.deleteFromStorage(res)})})\n                                    .catch(e => console.error(\"Critical failure: \" + e.message));\n                            }\n                            fetch('/messageroutes',{\n                                signal: this.abortController.signal,\n                                method: 'POST',\n                                headers: {\n                                    'Content-Type': 'application/json',\n                                    'Accept': 'application/json'\n                                },\n                                body: JSON.stringify({\n                                    type: 5\n                                })\n                            })\n                            .then(res => res.json())\n                            .then(res => this.setState({unreadMsg: res}))\n                            .catch(e => console.error(\"Critical failure: \" + e.message));\n                        }\n            })\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    removeFromCart = (res, items) => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n        for (let i = 0; i < cart.length; i++) {\n            let d = 0;\n            for (let j = 0; j < items.length; j++) {\n                if (cart[i] === items[j].ad_id.toString()) d = 1;\n            }\n            if (d === 0) {\n                cart.splice(cart.indexOf(cart[i]), 1);\n                window.localStorage.setItem(res.userId, JSON.stringify(cart));\n            }\n        }\n    }\n\n    deleteFromStorage = (items) => {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {this.removeFromCart(res, items);})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    handleClickLogOut() {\n        window.location.href = '/';\n        fetch('/loginroutes', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: \"logout\"\n            })\n        }).then(res => res.json())\n            .then(res => this.props.logIn(res.loggedInUser, res.userId))\n            .then(() => this.goHome())\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    goHome = () => {\n        window.location.href = '/';\n    }\n\n    render() {\n        \n        let cartNum = this.state.cartNum;\n        let unreadMsg = this.state.unreadMsg;\n\n        const linkStyle = {\n            textDecoration: 'none',\n            color: 'black'\n        }\n\n        const userBtnStyle = {\n            color: 'white',\n            textShadow: '1px 1px black',\n            backgroundColor: 'rgb(255, 255, 255, 0)',\n            padding: 0,\n            border: 'none'\n        }\n\n        const logoutStyle = {\n            color: 'white',\n            textShadow: '1px 1px black',\n            backgroundColor: 'rgb(255, 255, 255, 0)',\n            paddinRight: 10,\n            border: 'none',\n            textDecoration: 'underline',\n            cursor: 'pointer'\n        }\n\n        return(\n            <div className=\"Upper-line\">\n                {this.props.loggedInUser === 'guest' ? <button className = 'btn'>\n                    <NavLink  exact to=\"/login_page\" className=\"first\" style={linkStyle} activeStyle={{fontWeight: \"bold\"}}>PRIJAVA</NavLink></button> :\n                <>\n                    <button style = {userBtnStyle}>Živjo {this.props.loggedInUser}! </button>\n                    <button\n                        style = {logoutStyle}\n                        onClick={this.handleClickLogOut}> (odjava)\n                    </button>\n                    <NavLink\n                        exact to=\"/user_listings\"\n                        className={['btn', 'first'].join(' ')}\n                        style={linkStyle}\n                        activeStyle={{fontWeight: \"bold\"}}>MOJA STRAN\n                    </NavLink>\n                    <NavLink \n                        exact to=\"/chatpage\"\n                        className={['btn', 'first'].join(' ')}\n                        style={linkStyle}\n                        activeStyle={{fontWeight: \"bold\"}}>{!unreadMsg ? 'SPOROČILA' : 'SPOROČILA (' + unreadMsg + ')'}\n                    </NavLink>\n                    <NavLink\n                        exact to=\"/shoppingcart\"\n                        className={['btn', 'first'].join(' ')}\n                        style={linkStyle}\n                        activeStyle={{fontWeight: \"bold\"}}>{!cartNum ? 'KOŠARICA' : 'KOŠARICA (' + cartNum + ')'}\n                    </NavLink>\n                </>}\n            </div>\n        )\n\n    }\n\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId,\n    };\n  };\n  \n  const mapDispatchToProps = {\n    logIn: logIn,\n    logOut: logOut\n  };\n\nexport default connect(mapStateToProps, mapDispatchToProps) (UpperLine);"]},"metadata":{},"sourceType":"module"}