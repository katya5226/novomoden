{"ast":null,"code":"var _jsxFileName = \"/home/katni/REACT/test-app/src/pages/Publish/ImgUpload.jsx\";\nimport React from 'react';\nimport { connect } from 'react-redux';\nimport ReactCrop from 'react-image-crop';\nimport Resizer from 'react-image-file-resizer';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport '../../App.css';\n\nclass ImgUpload extends React.PureComponent {\n  constructor(props) {\n    super(props);\n\n    this.onSelectFile = e => {\n      if (e.target.files && e.target.files.length > 0) {\n        var fileName, fileExtension;\n        fileName = e.target.files[0].name;\n        fileExtension = fileName.replace(/^.*\\./, '');\n\n        if (fileExtension === 'png' || fileExtension === 'jpg' || fileExtension === 'jpeg') {\n          this.readImageFile(e.target.files[0]);\n          Resizer.imageFileResizer(e.target.files[0], 450, 600, 'JPEG', 100, 0, uri => {\n            this.setState({\n              src: uri\n            });\n          }, 'base64');\n          this.setState({\n            file: e.target.files[0]\n          });\n          this.setState({\n            cropUrl: null\n          });\n        } else {\n          this.setState({\n            warning: 'Slika mora biti formata jpg, jpeg ali png!'\n          });\n        }\n      }\n    };\n\n    this.readImageFile = file => {\n      const reader = new FileReader();\n      let w;\n      let h;\n      var self = this;\n\n      reader.onload = function (e) {\n        let img = new Image();\n        img.src = e.target.result;\n\n        img.onload = function () {\n          w = this.width;\n          h = this.height;\n\n          if (w < 450 || h < 600) {\n            self.setState({\n              warning: 'Premajhna slika. Minimalna veikost slike je 450x600 px.'\n            });\n          } else self.setState({\n            warning: ''\n          });\n        };\n      };\n\n      reader.readAsDataURL(file);\n    };\n\n    this.onImageLoaded = image => {\n      this.imageRef = image;\n      this.setState({\n        dimensions: {\n          height: image.offsetHeight,\n          width: image.offsetWidth\n        }\n      });\n    };\n\n    this.onCropComplete = crop => {\n      this.makeClientCrop(crop);\n    };\n\n    this.onCropChange = (crop, percentCrop) => {\n      // You could also use percentCrop:\n      //this.setState({ crop: percentCrop });\n      this.setState({\n        crop\n      });\n    };\n\n    this.saveCrop = () => {\n      if (this.state.warning === '') {\n        this.setState({\n          cropUrl: this.state.croppedImageUrl,\n          src: '',\n          croppedImageUrl: ''\n        });\n        const photo = {\n          file: this.state.file,\n          crop: this.state.crop\n        };\n        this.props.callBackParent(photo, parseInt(this.props.index));\n      }\n    };\n\n    this.state = {\n      crop: {\n        unit: '%',\n        aspect: 3 / 4,\n        width: 50\n      },\n      src: null,\n      croppedImageUrl: '',\n      cropUrl: null,\n      file: null,\n      dimensions: {\n        height: 0,\n        width: 0\n      },\n      warning: ''\n    };\n  }\n\n  async makeClientCrop(crop) {\n    if (this.imageRef && crop.width && crop.height) {\n      const croppedImageUrl = await this.getCroppedImg(this.imageRef, crop, 'newFile.jpeg');\n      this.setState({\n        croppedImageUrl\n      });\n    }\n  }\n\n  getCroppedImg(image, crop, fileName) {\n    const canvas = document.createElement('canvas');\n    const scaleX = image.naturalWidth / image.width;\n    const scaleY = image.naturalHeight / image.height;\n    canvas.width = crop.width;\n    canvas.height = crop.height;\n    const ctx = canvas.getContext('2d');\n    ctx.drawImage(image, crop.x * scaleX, crop.y * scaleY, crop.width * scaleX, crop.height * scaleY, 0, 0, crop.width, crop.height);\n    return new Promise((resolve, reject) => {\n      canvas.toBlob(blob => {\n        if (!blob) {\n          //reject(new Error('Canvas is empty'));\n          console.error('Canvas is empty');\n          return;\n        }\n\n        blob.name = fileName;\n        window.URL.revokeObjectURL(this.fileUrl);\n        this.fileUrl = window.URL.createObjectURL(blob);\n        resolve(this.fileUrl);\n      }, 'image/jpeg');\n    });\n  }\n\n  render() {\n    const {\n      crop,\n      src\n    } = this.state;\n    return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"chosen_photos\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      id: \"input1\",\n      type: \"file\",\n      onChange: this.onSelectFile,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153,\n        columnNumber: 17\n      }\n    }, src && /*#__PURE__*/React.createElement(ReactCrop, {\n      src: src,\n      crop: crop,\n      ruleOfThirds: true,\n      onImageLoaded: this.onImageLoaded,\n      onComplete: this.onCropComplete,\n      onChange: this.onCropChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"p\", {\n      style: {\n        color: 'red'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 21\n      }\n    }, this.state.warning), !this.state.cropUrl && src && /*#__PURE__*/React.createElement(\"button\", {\n      id: \"1\",\n      className: \"btnb\",\n      onClick: this.saveCrop,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 54\n      }\n    }, \"SHRANI SLIKO\"), this.state.cropUrl && /*#__PURE__*/React.createElement(\"img\", {\n      alt: \"Crop1\",\n      style: {\n        width: '200px'\n      },\n      src: this.state.cropUrl,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 44\n      }\n    })));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nexport default connect(mapStateToProps)(ImgUpload);","map":{"version":3,"sources":["/home/katni/REACT/test-app/src/pages/Publish/ImgUpload.jsx"],"names":["React","connect","ReactCrop","Resizer","ImgUpload","PureComponent","constructor","props","onSelectFile","e","target","files","length","fileName","fileExtension","name","replace","readImageFile","imageFileResizer","uri","setState","src","file","cropUrl","warning","reader","FileReader","w","h","self","onload","img","Image","result","width","height","readAsDataURL","onImageLoaded","image","imageRef","dimensions","offsetHeight","offsetWidth","onCropComplete","crop","makeClientCrop","onCropChange","percentCrop","saveCrop","state","croppedImageUrl","photo","callBackParent","parseInt","index","unit","aspect","getCroppedImg","canvas","document","createElement","scaleX","naturalWidth","scaleY","naturalHeight","ctx","getContext","drawImage","x","y","Promise","resolve","reject","toBlob","blob","console","error","window","URL","revokeObjectURL","fileUrl","createObjectURL","render","color","mapStateToProps","loggedInUser","loggedInUserId"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport ReactCrop from 'react-image-crop';\nimport Resizer from 'react-image-file-resizer';\nimport 'react-image-crop/dist/ReactCrop.css';\nimport '../../App.css';\n\n\nclass ImgUpload extends React.PureComponent {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            crop: {\n                unit: '%',\n                aspect: 3 / 4,\n                width: 50\n            },\n            src: null,\n            croppedImageUrl: '',\n            cropUrl: null,\n            file: null,\n            dimensions: {\n                height: 0,\n                width: 0\n            },\n            warning: ''\n        };\n    }\n\n    onSelectFile = e => {\n        if (e.target.files && e.target.files.length > 0) {\n            var fileName, fileExtension;\n            fileName = e.target.files[0].name;\n            fileExtension = fileName.replace(/^.*\\./, '');\n            if (fileExtension === 'png' || fileExtension === 'jpg' || fileExtension === 'jpeg') {\n                this.readImageFile(e.target.files[0]);\n                Resizer.imageFileResizer(\n                    e.target.files[0],\n                    450,\n                    600,\n                    'JPEG',\n                    100,\n                    0,\n                    uri => { this.setState({src: uri}); },\n                    'base64'\n                );\n                this.setState({file: e.target.files[0]});\n                this.setState({cropUrl: null});\n            } else {this.setState({warning: 'Slika mora biti formata jpg, jpeg ali png!'})}\n        }\n    };\n\n    readImageFile = (file) => {\n        const reader = new FileReader();\n        let w;\n        let h;\n        var self = this;\n        reader.onload = function (e) {\n            let img = new Image();      \n            img.src = e.target.result;\n            img.onload = function () {\n                w = this.width;\n                h = this.height;\n                if (w < 450 || h < 600) {\n                    self.setState({warning: 'Premajhna slika. Minimalna veikost slike je 450x600 px.'});\n                } else self.setState({warning: ''});\n            }\n        };\n        reader.readAsDataURL(file);\n    }\n\n    onImageLoaded = image => {\n        this.imageRef = image;\n        this.setState({dimensions:{height:image.offsetHeight,\n            width:image.offsetWidth}});\n    };\n    \n    onCropComplete = crop => {\n        this.makeClientCrop(crop);\n    };\n    \n    onCropChange = (crop, percentCrop) => {\n        // You could also use percentCrop:\n        //this.setState({ crop: percentCrop });\n        this.setState({ crop });\n    };\n\n    async makeClientCrop(crop) {\n        if (this.imageRef && crop.width && crop.height) {\n            const croppedImageUrl = await this.getCroppedImg(\n                this.imageRef,\n                crop,\n                'newFile.jpeg'\n            );\n            this.setState({ croppedImageUrl });\n        }\n    }\n\n    getCroppedImg(image, crop, fileName) {\n        const canvas = document.createElement('canvas');\n        const scaleX = image.naturalWidth / image.width;\n        const scaleY = image.naturalHeight / image.height;\n        canvas.width = crop.width;\n        canvas.height = crop.height;\n        const ctx = canvas.getContext('2d');\n\n    ctx.drawImage(\n        image,\n        crop.x * scaleX,\n        crop.y * scaleY,\n        crop.width * scaleX,\n        crop.height * scaleY,\n        0,\n        0,\n        crop.width,\n        crop.height\n    );\n\n    return new Promise((resolve, reject) => {\n        canvas.toBlob(blob => {\n            if (!blob) {\n                //reject(new Error('Canvas is empty'));\n                console.error('Canvas is empty');\n                return;\n            }\n            blob.name = fileName;\n            window.URL.revokeObjectURL(this.fileUrl);\n            this.fileUrl = window.URL.createObjectURL(blob);\n            resolve(this.fileUrl);\n            }, 'image/jpeg');\n        });\n    }\n\n    saveCrop = () => {\n        if(this.state.warning === '') {\n            this.setState({cropUrl: this.state.croppedImageUrl, src: '', croppedImageUrl: ''});\n            const photo = {file: this.state.file, crop: this.state.crop};\n            this.props.callBackParent(photo, parseInt(this.props.index));\n        }\n    }\n\n    render() {\n\n        const { crop, src } = this.state;\n        return (\n            <>\n                <div className=\"chosen_photos\">\n                    <input id=\"input1\" type=\"file\" onChange={this.onSelectFile} />\n                    <br/>\n                    <br/>\n                </div>\n                <div>\n                    {src && (\n                        <ReactCrop\n                            src={src}\n                            crop={crop}\n                            ruleOfThirds\n                            onImageLoaded={this.onImageLoaded}\n                            onComplete={this.onCropComplete}\n                            onChange={this.onCropChange}\n                        />\n                    )}\n                    <p style={{ color: 'red' }}>{this.state.warning}</p>\n                    {(!this.state.cropUrl && src) && <button id='1' className = 'btnb' onClick={this.saveCrop}>SHRANI SLIKO</button>}\n                    {this.state.cropUrl && <img alt=\"Crop1\" style={{ width: '200px' }} src={this.state.cropUrl}/>}\n                </div>\n            </>\n        );\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n\nexport default connect(mapStateToProps) (ImgUpload);\n"]},"metadata":{},"sourceType":"module"}