{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/ShoppingCart/OrderPage.jsx\";\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport OrderListing from './OrderListing';\nimport FinishOrderData from './FinishOrderData';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\nclass OrderPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.cancelOrder = () => {\n      fetch('/sessionorder', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          type: 1,\n          ids: []\n        })\n      }).then(() => this.setState({\n        canceled: true\n      })).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.removeFromCart = () => {\n      let cart = JSON.parse(window.localStorage.getItem(this.props.loggedInUserId));\n      const adIds = this.state.adIds;\n      adIds.forEach(adId => {\n        cart.splice(cart.indexOf(adId.toString()), 1);\n      });\n      window.localStorage.setItem(this.props.loggedInUserId, JSON.stringify(cart));\n    };\n\n    this.finishOrder = () => {\n      this.setState({\n        loading: true\n      });\n      const price = this.priceSum(this.state.order, this.state.order.length);\n      const postage = this.postageSum(this.state.order, this.state.order.length);\n      fetch('/placeorder', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          order: {\n            ids: this.state.adIds,\n            price: price,\n            postage: postage,\n            seller_id: this.state.order[0].user_id,\n            seller: this.state.order[0].username,\n            status: -1,\n            shippingAddress: this.state.shippingAddress\n          }\n        })\n      }).then(res => res.json()).then(res => this.setState({\n        redirectUrl: res.redirectUrl\n      })).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.handleOrder = () => {\n      this.setState({\n        orderStatus: 'ORDERED!'\n      });\n    };\n\n    this.priceSum = (order, n) => {\n      let price = 0;\n\n      for (let i = 0; i < n; i++) {\n        price += order[i].price;\n      }\n\n      return price;\n    };\n\n    this.postageSum = (order, n) => {\n      let weight = 0;\n      let postage = 0;\n\n      for (let i = 0; i < n; i++) {\n        weight += order[i].weight;\n      }\n\n      postage = weight / 100 + 1;\n      return postage;\n    };\n\n    this.goToPage = redUrl => {\n      window.location.href = redUrl;\n    };\n\n    this.changeAddress = address => {\n      this.setState({\n        shippingAddress: address\n      });\n    };\n\n    this.switchRender = () => {\n      const order = this.state.order;\n      const n = order.length;\n      const price = this.priceSum(order, n);\n      const postage = this.postageSum(order, n);\n\n      if (this.state.redirectUrl !== '') {\n        this.goToPage(this.state.redirectUrl);\n      } else if (this.state.userId === '0') {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.5)'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 22\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 168,\n            columnNumber: 27\n          }\n        }), /*#__PURE__*/React.createElement(\"h2\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169,\n            columnNumber: 17\n          }\n        }, \"PROSIMO PRIJAVITE SE V SISTEM!\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 22\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 170,\n            columnNumber: 27\n          }\n        }));\n      } else if (!n) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 176,\n            columnNumber: 25\n          }\n        }, \"O NE! NEKAJ JE \\u0160LO NAROBE. IZDELKI NISO VE\\u010C NA VOLJO.\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/shoppingcart\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }\n        }, \"NAZAJ NA KO\\u0160ARICO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }\n        }));\n      } else if (n && !this.state.canceled && !this.state.finished) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            padding: '30px',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            textAlign: 'left',\n            paddingLeft: '50px',\n            fontSize: 'Large'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 32\n          }\n        }, \"ODDAJ NARO\\u010CILO\"))), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            float: 'left',\n            paddingRight: '100px',\n            minHeight: '70vh'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }\n        }, this.state.order.map(item => /*#__PURE__*/React.createElement(OrderListing, {\n          key: item.ad_id,\n          description: item,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 59\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            textAlign: 'left'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(FinishOrderData, {\n          callbackParent: this.changeAddress,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 29\n          }\n        }, \"Cena: \", price, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 29\n          }\n        }, \"Cena po\\u0161tnine: \", postage, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"p\", {\n          style: {\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 29\n          }\n        }, \"Skupaj: \", price + postage, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btnb\",\n          onClick: this.finishOrder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 29\n          }\n        }, \"ZAKLJU\\u010CI NARO\\u010CILO\"), /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btnb\",\n          onClick: this.cancelOrder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 29\n          }\n        }, \"PREKLI\\u010CI NARO\\u010CILO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 200,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(ClipLoader, {\n          size: 50,\n          color: \"#123abc\",\n          loading: this.state.loading,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 201,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 29\n          }\n        }, this.state.orderStatus)), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            clear: 'both'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 25\n          }\n        })));\n      } else if (this.state.canceled && !this.state.finished) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 25\n          }\n        }, \"NARO\\u010CILO PREKLICANO!\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/shoppingcart\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 25\n          }\n        }, \"NAZAJ NA KO\\u0160ARICO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 25\n          }\n        }));\n      } else if (this.state.finished && !this.state.canceled) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 224,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 25\n          }\n        }), !this.state.error && /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 47\n          }\n        }, \"NARO\\u010CILO ZAKLJU\\u010CENO!\"), this.state.error && /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 46\n          }\n        }, \"NAPAKA! EDEN ALI VE\\u010C IZDELKOV \\u017DAL NI VE\\u010C NA VOLJO!\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 25\n          }\n        }, \"DOMOV\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 25\n          }\n        }));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 30\n          }\n        }));\n      }\n    };\n\n    this.state = {\n      orderStatus: '',\n      adIds: [],\n      order: [],\n      shippingAddress: null,\n      fetching: true,\n      canceled: false,\n      finished: false,\n      error: false,\n      loading: false,\n      userId: '0',\n      redirectUrl: ''\n    };\n  }\n\n  componentDidMount() {\n    fetch('/sessionorder', {\n      signal: this.abortController.signal,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        type: 2\n      })\n    }).then(res => res.json()).then(res => {\n      const adIds = JSON.parse(res);\n      this.setState({\n        adIds\n      });\n      adIds.length && fetch('/cartListings', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify(adIds)\n      }).then(res => res.json()).then(res => {\n        this.setState({\n          order: res\n        });\n      }) //.then(res => console.log(res))\n      .catch(e => console.error(\"Critical failure: \" + e.message));\n    }).catch(e => console.error(\"Critical failure: \" + e.message));\n    fetch('/sessionroutes', {\n      signal: this.abortController.signal\n    }).then(res => res.json()).then(res => this.setState({\n      userId: res.userId\n    })).catch(e => console.error(\"Critical failure: \" + e.message));\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242,\n        columnNumber: 21\n      }\n    }), this.switchRender(), /*#__PURE__*/React.createElement(AdSpace, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 21\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nconst mapDispatchToProps = {\n  logIn: logIn,\n  logOut: logOut\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderPage);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/ShoppingCart/OrderPage.jsx"],"names":["React","NavLink","connect","logIn","logOut","OrderListing","FinishOrderData","UpperLine","Header","Bottom","BreadCrumbs","NavBar","AdSpace","ClipLoader","OrderPage","Component","constructor","props","abortController","AbortController","cancelOrder","fetch","signal","method","headers","body","JSON","stringify","type","ids","then","setState","canceled","catch","e","console","error","message","removeFromCart","cart","parse","window","localStorage","getItem","loggedInUserId","adIds","state","forEach","adId","splice","indexOf","toString","setItem","finishOrder","loading","price","priceSum","order","length","postage","postageSum","seller_id","user_id","seller","username","status","shippingAddress","res","json","redirectUrl","handleOrder","orderStatus","n","i","weight","goToPage","redUrl","location","href","changeAddress","address","switchRender","userId","backgroundColor","margin","finished","padding","textAlign","paddingLeft","fontSize","float","paddingRight","minHeight","map","item","ad_id","fontWeight","clear","fetching","componentDidMount","componentWillUnmount","abort","render","pathname","mapStateToProps","loggedInUser","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport OrderListing from './OrderListing';\nimport FinishOrderData from './FinishOrderData';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\n\nclass OrderPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            orderStatus: '',\n            adIds: [],\n            order: [],\n            shippingAddress: null,\n            fetching: true,\n            canceled: false,\n            finished: false,\n            error: false,\n            loading: false,\n            userId: '0',\n            redirectUrl: ''\n        };\n    }\n\n    abortController = new AbortController();\n\n    componentDidMount() {\n        fetch('/sessionorder', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: 2,\n            })\n        }).then(res => res.json())\n            .then(res => { const adIds = JSON.parse(res); this.setState({adIds});\n                (adIds.length) && fetch('/cartListings', {\n                                    signal: this.abortController.signal,\n                                    method: 'POST',\n                                    headers: {\n                                        'Content-Type': 'application/json',\n                                        'Accept': 'application/json'\n                                    },\n                                    body: JSON.stringify(adIds)\n                                }).then(res => res.json())\n                                    .then(res => {this.setState({order: res})})\n                                    //.then(res => console.log(res))\n                                    .catch(e => console.error(\"Critical failure: \" + e.message));})\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => this.setState({userId: res.userId}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    cancelOrder = () => {\n        fetch('/sessionorder', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: 1,\n                ids: []\n            })\n        }).then(() => this.setState({canceled: true}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    removeFromCart = () => {\n        let cart = JSON.parse(window.localStorage.getItem(this.props.loggedInUserId));\n        const adIds = this.state.adIds;\n        adIds.forEach(adId => {\n            cart.splice(cart.indexOf(adId.toString()), 1);\n        })\n        window.localStorage.setItem(this.props.loggedInUserId, JSON.stringify(cart));\n    }\n\n    finishOrder = () => {\n        this.setState({loading: true});\n        const price = this.priceSum(this.state.order, this.state.order.length);\n        const postage = this.postageSum(this.state.order, this.state.order.length);\n        fetch('/placeorder', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                order: {\n                    ids: this.state.adIds,\n                    price: price,\n                    postage: postage,\n                    seller_id: this.state.order[0].user_id,\n                    seller: this.state.order[0].username,\n                    status: -1,\n                    shippingAddress: this.state.shippingAddress\n                }\n\n            })\n        }).then(res => res.json())\n        .then(res => this.setState({redirectUrl: res.redirectUrl}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    handleOrder = () => {\n        this.setState({orderStatus: 'ORDERED!'});\n    }\n\n    priceSum = (order, n) => {\n        let price = 0;\n        for (let i = 0; i < n; i++) {\n            price += order[i].price;\n        }\n        return price;\n    }\n    postageSum = (order, n) => {\n        let weight = 0;\n        let postage = 0;\n        for (let i = 0; i < n; i++) {\n            weight += order[i].weight;\n        }\n        postage = weight/100 +1;\n        return postage;\n    }\n\n    goToPage = (redUrl) => {\n        window.location.href = redUrl;\n    }\n\n    changeAddress = (address) => {\n        this.setState({shippingAddress: address});\n    }\n\n    switchRender = () => {\n\n        const order = this.state.order;\n        const n = order.length;\n        const price = this.priceSum(order, n);\n        const postage = this.postageSum(order, n);\n\n        if(this.state.redirectUrl !== '') {\n            this.goToPage(this.state.redirectUrl);\n        }\n        else if (this.state.userId === '0') {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                <br/><br/><br/>\n                <h2>PROSIMO PRIJAVITE SE V SISTEM!</h2>\n                <br/><br/><br/>\n            </div>\n        }\n        else if (!n) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>O NE! NEKAJ JE ŠLO NAROBE. IZDELKI NISO VEČ NA VOLJO.</h1>\n                        <NavLink exact to = '/shoppingcart' className = 'btnb'>NAZAJ NA KOŠARICO</NavLink>\n                        <br/>\n                    </div>\n        }\n        else if (n && !this.state.canceled && !this.state.finished) {\n            return <div style = {{padding: '30px', margin: '0 auto'}}>\n                    <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <div style={{textAlign: 'left', paddingLeft: '50px', fontSize: 'Large'}}>\n                            <br/>\n                            <p><b>ODDAJ NAROČILO</b></p>\n                        </div>\n                        <br/>\n                        <div style = {{float: 'left', paddingRight: '100px', minHeight: '70vh'}}>\n                            {this.state.order.map(item => <OrderListing key ={item.ad_id} description = {item}/>)}\n                        </div>\n                        <div style = {{textAlign: 'left'}}>\n                            <FinishOrderData callbackParent={this.changeAddress}/>\n                            <br/>\n                            <p>Cena: {price} €</p>\n                            <p>Cena poštnine: {postage} €</p>\n                            <p style = {{fontWeight: 'bold'}}>Skupaj: {price + postage} €</p>\n                            <button className = 'btnb' onClick = {this.finishOrder}>ZAKLJUČI NAROČILO</button>\n                            <button className = 'btnb' onClick = {this.cancelOrder}>PREKLIČI NAROČILO</button>\n                            <br/>\n                            <ClipLoader\n                                size={50}\n                                color={\"#123abc\"}\n                                loading={this.state.loading}\n                            />\n                            <br/>\n                            <p>{this.state.orderStatus}</p>\n                        </div>\n                        <br/>\n                        <div style = {{clear: 'both'}}>\n\n                        </div>\n                        <br/>\n                    </div>\n                </div>\n        } else if (this.state.canceled && !this.state.finished) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>NAROČILO PREKLICANO!</h1>\n                        <NavLink exact to = '/shoppingcart' className = 'btnb'>NAZAJ NA KOŠARICO</NavLink>\n                        <br/>\n                    </div>\n        } else if (this.state.finished && !this.state.canceled) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        {!this.state.error && <h1>NAROČILO ZAKLJUČENO!</h1>}\n                        {this.state.error && <h1>NAPAKA! EDEN ALI VEČ IZDELKOV ŽAL NI VEČ NA VOLJO!</h1>}\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        } else {\n            return <div><br/><br/></div>\n        }\n\n    }\n\n    render() {\n        return <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    {this.switchRender()}\n                    <AdSpace/>\n                    <Bottom/>\n                </div>\n  \n    }\n    \n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n  \n  const mapDispatchToProps = {\n    logIn: logIn,\n    logOut: logOut\n  };\n\nexport default connect(mapStateToProps, mapDispatchToProps) (OrderPage);\n"]},"metadata":{},"sourceType":"module"}