{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/ShoppingCart/ShoppingCartPage.jsx\";\nimport React from 'react';\nimport '../../App.css';\nimport { connect } from 'react-redux';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport Bottom from '../../components/Bottom';\nimport CartGroup from './CartGroup';\nimport BreadCrumbs from '../../components/BreadCrumbs';\n\nclass ShoppingCartPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.getCart = () => {\n      fetch('/sessionroutes', {\n        signal: this.abortController.signal\n      }).then(res => res.json()).then(res => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n\n        if (cart) {\n          cart.length && fetch('/cartListings', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json'\n            },\n            body: JSON.stringify(cart)\n          }).then(res => res.json()).then(res => {\n            this.setState({\n              sortedCart: res\n            }, () => {\n              res.length !== cart.length && this.deleteFromStorage(res);\n              console.log(res);\n              console.log(cart);\n            });\n          }).catch(e => console.error(\"Critical failure: \" + e.message));\n          !cart.length && this.setState({\n            sortedCart: []\n          });\n        }\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.reMount = () => {\n      this.getCart();\n    };\n\n    this.deleteFromStorage = items => {\n      fetch('/sessionroutes', {\n        signal: this.abortController.signal\n      }).then(res => res.json()).then(res => {\n        this.removeFromCart(res, items);\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.removeFromCart = (res, items) => {\n      let cart = JSON.parse(window.localStorage.getItem(res.userId));\n      console.log(cart);\n\n      for (let i = 0; i < cart.length; i++) {\n        let d = 0;\n\n        for (let j = 0; j < items.length; j++) {\n          if (cart[i] === items[j].ad_id.toString()) d = 1;\n        }\n\n        if (d === 0) {\n          console.log(cart[i]);\n          cart.splice(cart.indexOf(cart[i]), 1);\n          window.localStorage.setItem(res.userId, JSON.stringify(cart));\n        }\n      }\n    };\n\n    this.listCart = () => {\n      const sCart = this.state.sortedCart;\n      let componentArray = [];\n      let sellerArray = [];\n      let listingArray = [];\n\n      if (sCart.length > 0) {\n        let seller;\n        let weight;\n        let i = 0;\n        let j = 0;\n\n        while (i < sCart.length) {\n          seller = sCart[i].username;\n          weight = 0;\n\n          while (j < sCart.length && sCart[j].username === seller) {\n            listingArray.push(sCart[j]);\n            j++;\n          }\n\n          sellerArray.push(listingArray);\n          componentArray.push( /*#__PURE__*/React.createElement(CartGroup, {\n            key: j,\n            items: listingArray,\n            loggedInUserId: this.props.loggedInUserId,\n            callBackParent: this.reMount,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 121,\n              columnNumber: 37\n            }\n          }));\n          listingArray = [];\n          i = j;\n        }\n      }\n\n      return componentArray;\n    };\n\n    this.showCart = () => {\n      //console.log(JSON.parse(window.localStorage.getItem(this.props.loggedInUserId)));\n      console.log(JSON.parse(window.localStorage.getItem(21)));\n      console.log(this.state.sortedCart);\n      console.log(this.state.cart);\n    };\n\n    this.state = {\n      cart: [],\n      sortedCart: []\n    };\n  }\n\n  componentDidMount() {\n    this.getCart();\n    this.showCart();\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    let len = this.state.sortedCart.length;\n\n    if (!len) {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"App\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(UpperLine, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(Header, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(NavBar, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n        pathname: this.props.location.pathname,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 21\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        style: {\n          backgroundColor: 'rgb(255,255,255,0.5)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 30\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152,\n          columnNumber: 35\n        }\n      }), /*#__PURE__*/React.createElement(\"h2\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153,\n          columnNumber: 25\n        }\n      }, \"KO\\u0160ARICA JE PRAZNA!\"), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 25\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 30\n        }\n      }), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 154,\n          columnNumber: 35\n        }\n      })), /*#__PURE__*/React.createElement(Bottom, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 21\n        }\n      }));\n    } else return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        padding: '30px'\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 17\n      }\n    }, this.listCart()), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nexport default connect(mapStateToProps)(ShoppingCartPage);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/ShoppingCart/ShoppingCartPage.jsx"],"names":["React","connect","UpperLine","Header","NavBar","Bottom","CartGroup","BreadCrumbs","ShoppingCartPage","Component","constructor","props","abortController","AbortController","getCart","fetch","signal","then","res","json","cart","JSON","parse","window","localStorage","getItem","userId","length","method","headers","body","stringify","setState","sortedCart","deleteFromStorage","console","log","catch","e","error","message","reMount","items","removeFromCart","i","d","j","ad_id","toString","splice","indexOf","setItem","listCart","sCart","state","componentArray","sellerArray","listingArray","seller","weight","username","push","loggedInUserId","showCart","componentDidMount","componentWillUnmount","abort","render","len","location","pathname","backgroundColor","padding","mapStateToProps","loggedInUser"],"mappings":"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","sourcesContent":["import React from 'react';\nimport '../../App.css';\nimport { connect } from 'react-redux';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport Bottom from '../../components/Bottom';\nimport CartGroup from './CartGroup';\nimport BreadCrumbs from '../../components/BreadCrumbs';\n\n\nclass ShoppingCartPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n                cart: [],\n                sortedCart: []\n        };\n\n    }\n    abortController = new AbortController();\n\n    //zaenkrat ta komponenta ne potrebuje connecta na redux ker sem morala klicati userja iz baze:\n\n    getCart = () => {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {let cart = JSON.parse(window.localStorage.getItem(res.userId));\n            if(cart) {\n                (cart.length) && fetch('/cartListings', {\n                    signal: this.abortController.signal,\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Accept': 'application/json'\n                    },\n                    body: JSON.stringify(cart)\n                }).then(res => res.json())\n                    .then(res => {this.setState({sortedCart: res}, () => {(res.length !== cart.length) && this.deleteFromStorage(res); console.log(res); console.log(cart);})})\n                    .catch(e => console.error(\"Critical failure: \" + e.message));\n\n                (!cart.length) && this.setState({sortedCart: []});\n            }\n        })\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentDidMount() {\n        this.getCart();\n        this.showCart();\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    reMount = () => {\n        this.getCart();\n    }\n\n    deleteFromStorage = (items) => {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {this.removeFromCart(res, items);})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    /*removeFromCart = (res, items) => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n        for (let i = 0; i < cart.length; i++) {\n            let d = 0;\n            for (let j = 0; j < items.length; j++) {\n                if (cart[i] == items[j].ad_id.toString()) d = 1;\n            }\n            if (d == 0) {\n                if (cart !== null) {\n                    window.localStorage.setItem(res.userId, JSON.stringify(cart));\n                }\n            }\n        }\n    }*/\n\n    removeFromCart = (res, items) => {\n        let cart = JSON.parse(window.localStorage.getItem(res.userId));\n        console.log(cart);\n        for (let i = 0; i < cart.length; i++) {\n            let d = 0;\n            for (let j = 0; j < items.length; j++) {\n                if (cart[i] === items[j].ad_id.toString()) d = 1;\n            }\n            if (d === 0) {\n                console.log(cart[i])\n                cart.splice(cart.indexOf(cart[i]), 1);\n                window.localStorage.setItem(res.userId, JSON.stringify(cart));\n            }\n        }\n    }\n\n\n\n    listCart = () => {\n        const sCart = this.state.sortedCart;\n        let componentArray = [];\n        let sellerArray = [];\n        let listingArray = [];\n\n        if (sCart.length > 0) {\n            let seller;\n            let weight;\n\n            let i = 0; let j = 0;\n            while (i < sCart.length) {\n                seller = sCart[i].username;\n                weight = 0;\n                while (j < sCart.length && sCart[j].username === seller) {\n                    listingArray.push(sCart[j]);\n                    j++;\n                }\n                sellerArray.push(listingArray);\n                componentArray.push(<CartGroup\n                                        key={j}\n                                        items = {listingArray}\n                                        loggedInUserId = {this.props.loggedInUserId}\n                                        callBackParent = {this.reMount}/>);\n                listingArray = [];\n                i = j;\n            }\n        }   \n        return componentArray;\n    }\n\n    showCart = () => {\n        //console.log(JSON.parse(window.localStorage.getItem(this.props.loggedInUserId)));\n        console.log(JSON.parse(window.localStorage.getItem(21)));\n        console.log(this.state.sortedCart);\n        console.log(this.state.cart);\n    }\n\n    render() {\n\n        let len = this.state.sortedCart.length;\n\n        if (!len) {\n            return (\n                <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                        <br/><br/><br/>\n                        <h2>KOŠARICA JE PRAZNA!</h2>\n                        <br/><br/><br/>\n                    </div>\n                    <Bottom/>\n                </div>\n                )\n        }\n        else return (\n            <div className=\"App\">\n                <UpperLine/>\n                <Header/>\n                <NavBar/>\n                <BreadCrumbs pathname = {this.props.location.pathname}/>\n                <div style = {{padding: '30px'}}>\n                    {this.listCart()}\n                </div>\n                <Bottom/>\n            </div>\n        );\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId,\n    };\n};\n\nexport default connect(mapStateToProps) (ShoppingCartPage);\n"]},"metadata":{},"sourceType":"module"}