{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/ShoppingCart/OrderPage.jsx\";\nimport React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport OrderListing from './OrderListing';\nimport FinishOrderData from './FinishOrderData';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\nclass OrderPage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.cancelOrder = () => {\n      fetch('/orderroutes', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          type: 1,\n          ids: []\n        })\n      }).then(() => this.setState({\n        canceled: true\n      })).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.removeFromCart = () => {\n      let cart = JSON.parse(window.localStorage.getItem(this.props.loggedInUserId));\n      const adIds = this.state.adIds;\n      adIds.forEach(adId => {\n        cart.splice(cart.indexOf(adId.toString()), 1);\n      });\n      window.localStorage.setItem(this.props.loggedInUserId, JSON.stringify(cart));\n    };\n\n    this.finishOrder = () => {\n      this.setState({\n        loading: true\n      });\n      const price = this.priceSum(this.state.order, this.state.order.length);\n      const postage = this.postageSum(this.state.order, this.state.order.length);\n      fetch('/orderroutes', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify({\n          type: 3,\n          order: {\n            ids: this.state.adIds,\n            price: price,\n            postage: postage,\n            seller_id: this.state.order[0].user_id,\n            seller: this.state.order[0].username,\n            status: 0\n          }\n        })\n      }).then(res => res.json()).then(res => {\n        if (res.success) {\n          this.setState({\n            finished: true,\n            loading: false\n          });\n        } else {\n          this.setState({\n            finished: true,\n            error: true\n          });\n        }\n\n        this.removeFromCart();\n      }).catch(e => console.error(\"Critical failure: \" + e.message));\n    };\n\n    this.handleOrder = () => {\n      this.setState({\n        orderStatus: 'ORDERED!'\n      });\n    };\n\n    this.priceSum = (order, n) => {\n      let price = 0;\n\n      for (let i = 0; i < n; i++) {\n        price += order[i].price;\n      }\n\n      return price;\n    };\n\n    this.postageSum = (order, n) => {\n      let weight = 0;\n      let postage = 0;\n\n      for (let i = 0; i < n; i++) {\n        weight += order[i].weight;\n      }\n\n      postage = weight / 100 + 1;\n      return postage;\n    };\n\n    this.switchRender = () => {\n      const order = this.state.order;\n      const n = order.length;\n      const price = this.priceSum(order, n);\n      const postage = this.postageSum(order, n);\n\n      if (this.state.userId === '0') {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.5)'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 156,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 22\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 157,\n            columnNumber: 27\n          }\n        }), /*#__PURE__*/React.createElement(\"h2\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 17\n          }\n        }, \"PROSIMO PRIJAVITE SE V SISTEM!\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 17\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 22\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 27\n          }\n        }));\n      } else if (!n) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 164,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 165,\n            columnNumber: 25\n          }\n        }, \"O NE! NEKAJ JE \\u0160LO NAROBE. IZDELKI NISO VE\\u010C NA VOLJO.\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/shoppingcart\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 25\n          }\n        }, \"NAZAJ NA KO\\u0160ARICO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 167,\n            columnNumber: 25\n          }\n        }));\n      } else if (n && !this.state.canceled && !this.state.finished) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            padding: '30px',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 171,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 172,\n            columnNumber: 21\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            textAlign: 'left'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 174,\n            columnNumber: 29\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 29\n          }\n        }, /*#__PURE__*/React.createElement(\"b\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 175,\n            columnNumber: 32\n          }\n        }, \"ODDAJ NARO\\u010CILO\"))), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 177,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            float: 'left',\n            paddingRight: '100px'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 178,\n            columnNumber: 25\n          }\n        }, this.state.order.map(item => /*#__PURE__*/React.createElement(OrderListing, {\n          key: item.ad_id,\n          description: item,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 179,\n            columnNumber: 59\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            textAlign: 'left'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 181,\n            columnNumber: 25\n          }\n        }, /*#__PURE__*/React.createElement(FinishOrderData, {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 183,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 184,\n            columnNumber: 25\n          }\n        }, \"Cena: \", price, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 185,\n            columnNumber: 25\n          }\n        }, \"Cena po\\u0161tnine: \", postage, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"p\", {\n          style: {\n            fontWeight: 'bold'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 186,\n            columnNumber: 25\n          }\n        }, \"Skupaj: \", price + postage, \" \\u20AC\"), /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btnb\",\n          onClick: this.finishOrder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 25\n          }\n        }, \"ZAKLJU\\u010CI NARO\\u010CILO\"), /*#__PURE__*/React.createElement(\"button\", {\n          className: \"btnb\",\n          onClick: this.cancelOrder,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188,\n            columnNumber: 25\n          }\n        }, \"PREKLI\\u010CI NARO\\u010CILO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(ClipLoader, {\n          size: 50,\n          color: \"#123abc\",\n          loading: this.state.loading,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"p\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 196,\n            columnNumber: 25\n          }\n        }, this.state.orderStatus)), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            clear: 'both'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 202,\n            columnNumber: 25\n          }\n        })));\n      } else if (this.state.canceled && !this.state.finished) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 207,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 208,\n            columnNumber: 25\n          }\n        }, \"NARO\\u010CILO PREKLICANO!\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/shoppingcart\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 209,\n            columnNumber: 25\n          }\n        }, \"NAZAJ NA KO\\u0160ARICO\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 210,\n            columnNumber: 25\n          }\n        }));\n      } else if (this.state.finished && !this.state.canceled) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 25\n          }\n        }), !this.state.error && /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 47\n          }\n        }, \"NARO\\u010CILO ZAKLJU\\u010CENO!\"), this.state.error && /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 216,\n            columnNumber: 46\n          }\n        }, \"NAPAKA! EDEN ALI VE\\u010C IZDELKOV \\u017DAL NI VE\\u010C NA VOLJO!\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 25\n          }\n        }, \"DOMOV\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 25\n          }\n        }));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 221,\n            columnNumber: 30\n          }\n        }));\n      }\n    };\n\n    this.state = {\n      orderStatus: '',\n      adIds: [],\n      order: [],\n      fetching: true,\n      canceled: false,\n      finished: false,\n      error: false,\n      loading: false,\n      userId: '0'\n    };\n  }\n\n  componentDidMount() {\n    fetch('/orderroutes', {\n      signal: this.abortController.signal,\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        'Accept': 'application/json'\n      },\n      body: JSON.stringify({\n        type: 2\n      })\n    }).then(res => res.json()).then(res => {\n      const adIds = JSON.parse(res);\n      this.setState({\n        adIds\n      });\n      adIds.length && fetch('/cartListings', {\n        signal: this.abortController.signal,\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json'\n        },\n        body: JSON.stringify(adIds)\n      }).then(res => res.json()).then(res => {\n        this.setState({\n          order: res\n        });\n      }) //.then(res => console.log(res))\n      .catch(e => console.error(\"Critical failure: \" + e.message));\n    }).catch(e => console.error(\"Critical failure: \" + e.message));\n    fetch('/sessionroutes', {\n      signal: this.abortController.signal\n    }).then(res => res.json()).then(res => this.setState({\n      userId: res.userId\n    }, () => console.log(this.state.userId))).catch(e => console.error(\"Critical failure: \" + e.message));\n  }\n\n  componentWillUnmount() {\n    this.abortController.abort();\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 229,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 231,\n        columnNumber: 21\n      }\n    }), this.switchRender(), /*#__PURE__*/React.createElement(AdSpace, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 21\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nconst mapDispatchToProps = {\n  logIn: logIn,\n  logOut: logOut\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(OrderPage);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/ShoppingCart/OrderPage.jsx"],"names":["React","NavLink","connect","logIn","logOut","OrderListing","FinishOrderData","UpperLine","Header","Bottom","BreadCrumbs","NavBar","AdSpace","ClipLoader","OrderPage","Component","constructor","props","abortController","AbortController","cancelOrder","fetch","signal","method","headers","body","JSON","stringify","type","ids","then","setState","canceled","catch","e","console","error","message","removeFromCart","cart","parse","window","localStorage","getItem","loggedInUserId","adIds","state","forEach","adId","splice","indexOf","toString","setItem","finishOrder","loading","price","priceSum","order","length","postage","postageSum","seller_id","user_id","seller","username","status","res","json","success","finished","handleOrder","orderStatus","n","i","weight","switchRender","userId","backgroundColor","margin","padding","textAlign","float","paddingRight","map","item","ad_id","fontWeight","clear","fetching","componentDidMount","log","componentWillUnmount","abort","render","location","pathname","mapStateToProps","loggedInUser","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport OrderListing from './OrderListing';\nimport FinishOrderData from './FinishOrderData';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\n\nclass OrderPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            orderStatus: '',\n            adIds: [],\n            order: [],\n            fetching: true,\n            canceled: false,\n            finished: false,\n            error: false,\n            loading: false,\n            userId: '0'\n        };\n    }\n\n    abortController = new AbortController();\n\n    componentDidMount() {\n        fetch('/orderroutes', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: 2,\n            })\n        }).then(res => res.json())\n            .then(res => { const adIds = JSON.parse(res); this.setState({adIds});\n                (adIds.length) && fetch('/cartListings', {\n                                    signal: this.abortController.signal,\n                                    method: 'POST',\n                                    headers: {\n                                        'Content-Type': 'application/json',\n                                        'Accept': 'application/json'\n                                    },\n                                    body: JSON.stringify(adIds)\n                                }).then(res => res.json())\n                                    .then(res => {this.setState({order: res})})\n                                    //.then(res => console.log(res))\n                                    .catch(e => console.error(\"Critical failure: \" + e.message));})\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => this.setState({userId: res.userId}, () => console.log(this.state.userId)))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    cancelOrder = () => {\n        fetch('/orderroutes', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: 1,\n                ids: []\n            })\n        }).then(() => this.setState({canceled: true}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    removeFromCart = () => {\n        let cart = JSON.parse(window.localStorage.getItem(this.props.loggedInUserId));\n        const adIds = this.state.adIds;\n        adIds.forEach(adId => {\n            cart.splice(cart.indexOf(adId.toString()), 1);\n        })\n        window.localStorage.setItem(this.props.loggedInUserId, JSON.stringify(cart));\n    }\n\n    finishOrder = () => {\n        this.setState({loading: true});\n        const price = this.priceSum(this.state.order, this.state.order.length);\n        const postage = this.postageSum(this.state.order, this.state.order.length);\n        fetch('/orderroutes', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                type: 3,\n                order: {\n                    ids: this.state.adIds,\n                    price: price,\n                    postage: postage,\n                    seller_id: this.state.order[0].user_id,\n                    seller: this.state.order[0].username,\n                    status: 0\n                }\n\n            })\n        }).then(res => res.json())\n        .then(res => {if (res.success) {this.setState({finished: true, loading: false});}\n                        else {this.setState({finished: true, error: true});}\n                        this.removeFromCart();})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    handleOrder = () => {\n        this.setState({orderStatus: 'ORDERED!'});\n    }\n\n    priceSum = (order, n) => {\n        let price = 0;\n        for (let i = 0; i < n; i++) {\n            price += order[i].price;\n        }\n        return price;\n    }\n    postageSum = (order, n) => {\n        let weight = 0;\n        let postage = 0;\n        for (let i = 0; i < n; i++) {\n            weight += order[i].weight;\n        }\n        postage = weight/100 +1;\n        return postage;\n    }\n\n    switchRender = () => {\n\n        const order = this.state.order;\n        const n = order.length;\n        const price = this.priceSum(order, n);\n        const postage = this.postageSum(order, n);\n\n        if (this.state.userId === '0') {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                <br/><br/><br/>\n                <h2>PROSIMO PRIJAVITE SE V SISTEM!</h2>\n                <br/><br/><br/>\n            </div>\n        }\n        else if (!n) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>O NE! NEKAJ JE ŠLO NAROBE. IZDELKI NISO VEČ NA VOLJO.</h1>\n                        <NavLink exact to = '/shoppingcart' className = 'btnb'>NAZAJ NA KOŠARICO</NavLink>\n                        <br/>\n                    </div>\n        }\n        else if (n && !this.state.canceled && !this.state.finished) {\n            return <div style = {{padding: '30px', margin: '0 auto'}}>\n                    <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <div style={{textAlign: 'left'}}>\n                            <br/>\n                            <p><b>ODDAJ NAROČILO</b></p>\n                        </div>\n                        <br/>\n                        <div style = {{float: 'left', paddingRight: '100px'}}>\n                            {this.state.order.map(item => <OrderListing key ={item.ad_id} description = {item}/>)}\n                        </div>\n                        <div style = {{textAlign: 'left'}}>\n                        <FinishOrderData/>\n                        <br/>\n                        <p>Cena: {price} €</p>\n                        <p>Cena poštnine: {postage} €</p>\n                        <p style = {{fontWeight: 'bold'}}>Skupaj: {price + postage} €</p>\n                        <button className = 'btnb' onClick = {this.finishOrder}>ZAKLJUČI NAROČILO</button>\n                        <button className = 'btnb' onClick = {this.cancelOrder}>PREKLIČI NAROČILO</button>\n                        <br/>\n                        <ClipLoader\n                            size={50}\n                            color={\"#123abc\"}\n                            loading={this.state.loading}\n                        />\n                        <br/>\n                        <p>{this.state.orderStatus}</p>\n                        </div>\n                        <br/>\n                        <div style = {{clear: 'both'}}>\n\n                        </div>\n                        <br/>\n                    </div>\n                </div>\n        } else if (this.state.canceled && !this.state.finished) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>NAROČILO PREKLICANO!</h1>\n                        <NavLink exact to = '/shoppingcart' className = 'btnb'>NAZAJ NA KOŠARICO</NavLink>\n                        <br/>\n                    </div>\n        } else if (this.state.finished && !this.state.canceled) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        {!this.state.error && <h1>NAROČILO ZAKLJUČENO!</h1>}\n                        {this.state.error && <h1>NAPAKA! EDEN ALI VEČ IZDELKOV ŽAL NI VEČ NA VOLJO!</h1>}\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        } else {\n            return <div><br/><br/></div>\n        }\n\n    }\n\n    render() {\n        return <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    {this.switchRender()}\n                    <AdSpace/>\n                    <Bottom/>\n                </div>\n  \n    }\n    \n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n  \n  const mapDispatchToProps = {\n    logIn: logIn,\n    logOut: logOut\n  };\n\nexport default connect(mapStateToProps, mapDispatchToProps) (OrderPage);\n"]},"metadata":{},"sourceType":"module"}