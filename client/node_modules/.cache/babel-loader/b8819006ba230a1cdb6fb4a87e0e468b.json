{"ast":null,"code":"var _jsxFileName = \"/home/katja/REACT/test-app/src/pages/ShoppingCart/PaymentStatus.jsx\";\nimport React, { useEffect } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\nclass PaymentStatus extends React.Component {\n  constructor(props) {\n    super(props);\n    this.abortController = new AbortController();\n\n    this.checkPayment = () => {\n      function subStrAfterChars(str, char) {\n        return str.substring(str.indexOf(char) + 1);\n      }\n\n      const eventId = subStrAfterChars(window.location.href, '=');\n      useEffect(() => {\n        const timer = setTimeout(() => {\n          fetch('/paymentstatus', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n              eventId: eventId\n            })\n          }).then(res => res.json()).then(res => {\n            if (res.success) {\n              this.setState({\n                success: true,\n                eventId: res.orderId\n              });\n            }\n          }).catch(e => console.error(\"Critical failure: \" + e.message));\n        }, 100);\n        return () => clearTimeout(timer);\n      }, []);\n    };\n\n    this.switchRender = () => {\n      if (this.state.success) {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 74,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 76,\n            columnNumber: 25\n          }\n        }, \"PLA\\u010CILO JE SPREJETO! NARO\\u010CILO ZAKLJU\\u010CENO! \\u0160TEVILKA NARO\\u010CILA: \", this.state.eventId), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 77,\n            columnNumber: 25\n          }\n        }, \"DOMOV\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 78,\n            columnNumber: 25\n          }\n        }));\n      } else {\n        return /*#__PURE__*/React.createElement(\"div\", {\n          style: {\n            backgroundColor: 'rgb(255,255,255,0.7)',\n            margin: '0 auto'\n          },\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 20\n          }\n        }, /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 25\n          }\n        }), /*#__PURE__*/React.createElement(\"h1\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }\n        }, \"OJEJ, NEKAJ JE \\u0160LO NAROBE, PLA\\u010CILO NI USPELO.\"), /*#__PURE__*/React.createElement(NavLink, {\n          exact: true,\n          to: \"/\",\n          className: \"btnb\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 25\n          }\n        }, \"DOMOV\"), /*#__PURE__*/React.createElement(\"br\", {\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 25\n          }\n        }));\n      }\n    };\n\n    this.state = {\n      success: false,\n      eventId: ''\n    };\n  }\n\n  componentDidMount() {\n    this.checkPayment(); //this.interval = setInterval(() => {this.checkPayment();}, 3000);\n  }\n\n  //{if (res.success) {this.setState({success: true, eventId: eventId})}}\n  componentWillUnmount() {\n    this.abortController.abort(); //clearInterval(this.interval);\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"App\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 16\n      }\n    }, /*#__PURE__*/React.createElement(UpperLine, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(NavBar, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(BreadCrumbs, {\n      pathname: this.props.location.pathname,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 21\n      }\n    }), this.switchRender(), /*#__PURE__*/React.createElement(AdSpace, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }\n    }), /*#__PURE__*/React.createElement(Bottom, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }\n    }));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    loggedInUser: state.loggedInUser,\n    loggedInUserId: state.loggedInUserId\n  };\n};\n\nconst mapDispatchToProps = {\n  logIn: logIn,\n  logOut: logOut\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(PaymentStatus);","map":{"version":3,"sources":["/home/katja/REACT/test-app/src/pages/ShoppingCart/PaymentStatus.jsx"],"names":["React","useEffect","NavLink","connect","logIn","logOut","UpperLine","Header","Bottom","BreadCrumbs","NavBar","AdSpace","ClipLoader","PaymentStatus","Component","constructor","props","abortController","AbortController","checkPayment","subStrAfterChars","str","char","substring","indexOf","eventId","window","location","href","timer","setTimeout","fetch","signal","method","headers","body","JSON","stringify","then","res","json","success","setState","orderId","catch","e","console","error","message","clearTimeout","switchRender","state","backgroundColor","margin","componentDidMount","componentWillUnmount","abort","render","pathname","mapStateToProps","loggedInUser","loggedInUserId","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React, { useEffect } from 'react';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { logIn, logOut } from '../../redux/actions';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport NavBar from '../../components/NavBar';\nimport AdSpace from '../../components/AdSpace';\nimport ClipLoader from 'react-spinners/ClipLoader';\n\n\nclass PaymentStatus extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            success: false,\n            eventId: ''\n        };\n    }\n\n    abortController = new AbortController();\n\n    componentDidMount() {\n\n        this.checkPayment();\n        \n        //this.interval = setInterval(() => {this.checkPayment();}, 3000);\n\n    }\n\n    checkPayment = () => {\n\n\n\n        function subStrAfterChars(str, char) {\n            return str.substring(str.indexOf(char) + 1);\n        }\n        const eventId = subStrAfterChars(window.location.href, '=');\n\n        useEffect(() => {\n            const timer = setTimeout(() => {\n                fetch('/paymentstatus', {\n                    signal: this.abortController.signal,\n                    method: 'POST',\n                    headers: {\n                        'Content-Type': 'application/json',\n                        'Accept': 'application/json'\n                    },\n                    body: JSON.stringify({\n                        eventId: eventId\n                    })\n                }).then(res => res.json())\n                .then(res =>{if (res.success) {this.setState({success: true, eventId: res.orderId})}})\n                .catch(e => console.error(\"Critical failure: \" + e.message));\n            }, 100);\n            return () => clearTimeout(timer);\n          }, []);\n\n    }\n\n    //{if (res.success) {this.setState({success: true, eventId: eventId})}}\n\n    componentWillUnmount() {\n        this.abortController.abort();\n        //clearInterval(this.interval);\n    }\n\n    switchRender = () => {\n\n        if (this.state.success) {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>PLAČILO JE SPREJETO! NAROČILO ZAKLJUČENO! ŠTEVILKA NAROČILA: {this.state.eventId}</h1>\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        } else {\n            return <div style = {{backgroundColor: 'rgb(255,255,255,0.7)', margin:'0 auto'}}>\n                        <br/>\n                        <h1>OJEJ, NEKAJ JE ŠLO NAROBE, PLAČILO NI USPELO.</h1>\n                        <NavLink exact to = '/' className = 'btnb'>DOMOV</NavLink>\n                        <br/>\n                    </div>\n        }\n    }\n\n    render() {\n        return <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    {this.switchRender()}\n                    <AdSpace/>\n                    <Bottom/>\n                </div>\n  \n    }\n    \n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n  \n  const mapDispatchToProps = {\n    logIn: logIn,\n    logOut: logOut\n  };\n\nexport default connect(mapStateToProps, mapDispatchToProps) (PaymentStatus);\n"]},"metadata":{},"sourceType":"module"}