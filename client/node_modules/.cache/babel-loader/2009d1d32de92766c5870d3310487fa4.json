{"ast":null,"code":"import _objectSpread from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import{connect}from'react-redux';import UpperLine from'../../components/UpperLine';import Header from'../../components/Header';import NavBar from'../../components/NavBar';import UserSideBar from'./UserSideBar';import Bottom from'../../components/Bottom';import BreadCrumbs from'../../components/BreadCrumbs';import AdSpace from'../../components/AdSpace';import{FaEyeSlash,FaEye}from'react-icons/fa';import'../../App.css';var Profile=/*#__PURE__*/function(_React$Component){_inherits(Profile,_React$Component);var _super=_createSuper(Profile);function Profile(props){var _this;_classCallCheck(this,Profile);_this=_super.call(this,props);_this.abortController=new AbortController();_this.getProfileInfo=function(){fetch('/profileroutes',{signal:_this.abortController.signal,method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({requestType:1})}).then(function(res){return res.json();}).then(function(res){return _this.setState({profileInfo:res[0]});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});};_this.onEditButtonClick=function(){_this.setState({edit:true});};_this.changePhoneNumber=function(values){var value=values.value;var profileInfo=_objectSpread({},_this.state.profileInfo);profileInfo.phone_number=value;_this.setState({profileInfo:profileInfo});};_this.changeAddress=function(e){var profileInfo=_objectSpread({},_this.state.profileInfo);var _e$target=e.target,name=_e$target.name,value=_e$target.value;profileInfo[name]=value;_this.setState({profileInfo:profileInfo});};_this.updateInfo=function(e){e.preventDefault();console.log(_this.state.profileInfo);fetch('/profileroutes',{signal:_this.abortController.signal,method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({requestType:2,profileInfo:_this.state.profileInfo})}).then(function(res){return res.json();}).then(function(){return _this.setState({editInfo:false});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});};_this.changePassword=function(e){if(!_this.checkPassStrength(e.target.value)){_this.setState({warning:'Geslo mora biti dolgo vsaj 8 znakov in mora vsebovati vsaj dva od naslednjih znakov: mala črka, velika črka, številka.'});}else{_this.setState({warning:''});}_this.setState({password:e.target.value});};_this.updatePassword=function(e){e.preventDefault();if(_this.state.password!==''&&_this.state.warning===''){fetch('/profileroutes',{signal:_this.abortController.signal,method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({requestType:3,password:_this.state.password})}).then(function(res){return res.json();}).then(function(res){if(res.success)_this.setState({success:'Uspešno ste spremenili geslo.',editPass:false});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});}};_this.visibilityChange=function(){_this.setState({visible:!_this.state.visible});};_this.onEditButtonClick=function(e){if(e.target.id==='info'){_this.setState({editInfo:true});}if(e.target.id==='pass'){_this.setState({editPass:true});}if(e.target.id==='cancel'){_this.setState({editInfo:false,editPass:false});}};_this.switchRender=function(){var iconStyle={margin:'auto -50px',paddingTop:'0px',border:'none',backgroundColor:'rgb(255, 255, 255, 0)',verticalAlign:'middle'};if(_this.state.userId==='0'){return/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'rgb(255,255,255,0.5)'}},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h2\",null,\"PROSIMO PRIJAVITE SE V SISTEM!\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null));}else if(!_this.state.profileInfo){return/*#__PURE__*/React.createElement(\"div\",null);}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"userContainer\"},/*#__PURE__*/React.createElement(\"div\",{className:\"profile\"},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"IME: \"),_this.state.profileInfo.first_name),/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"PRIIMEK: \"),_this.state.profileInfo.last_name),!_this.state.editInfo&&/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"NASLOV ZA PO\\u0160ILJANJE: \"),\" \",_this.state.profileInfo.street_ship+', '+_this.state.profileInfo.post_number_ship+' '+_this.state.profileInfo.town_ship),_this.state.editInfo&&/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:_this.updateInfo},/*#__PURE__*/React.createElement(\"b\",null,\"NASLOV ZA PO\\u0160ILJANJE: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"street\",name:\"street_ship\",placeholder:\"Ulica in hi\\u0161na \\u0161tevilka\",value:_this.state.profileInfo.street_ship,style:{width:'200px'},maxLength:\"30\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"postnumber\",name:\"post_number_ship\",placeholder:\"Po\\u0161tna \\u0161t.\",value:_this.state.profileInfo.post_number_ship,style:{width:'150px'},maxLength:\"10\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"town\",name:\"town_ship\",placeholder:\"Kraj\",value:_this.state.profileInfo.town_ship,style:{width:'150px'},maxLength:\"30\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"b\",null,\"TELEFON: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"phonenumber\",name:\"phone_number\",value:_this.state.profileInfo.phone_number,style:{width:'200px'},maxLength:\"20\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"b\",null,\"IBAN: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"iban\",name:\"iban\",value:_this.state.profileInfo.iban,style:{width:'200px'},maxLength:\"30\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"b\",null,\"BIC banke: \"),/*#__PURE__*/React.createElement(\"input\",{type:\"text\",id:\"bic\",name:\"bic\",value:_this.state.profileInfo.bic,style:{width:'200px'},maxLength:\"10\",onChange:_this.changeAddress}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"button\",{className:\"btnb\",type:\"submit\"},\"SHRANI\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btnb\",style:{marginLeft:'5px'},onClick:_this.onEditButtonClick},\"PREKLI\\u010CI\"))),!_this.state.editInfo&&/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"TELEFON: \"),_this.state.profileInfo.phone_number),!_this.state.editInfo&&/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"IBAN: \"),\" \",_this.state.profileInfo.iban),!_this.state.editInfo&&/*#__PURE__*/React.createElement(\"p\",null,/*#__PURE__*/React.createElement(\"b\",null,\"BIC banke: \"),\" \",_this.state.profileInfo.bic),_this.state.editPass&&/*#__PURE__*/React.createElement(\"form\",{onSubmit:_this.updatePassword},\"SPREMENI GESLO: \",/*#__PURE__*/React.createElement(\"input\",{type:_this.state.visible?'text':'password',id:\"pass\",name:\"pass\",value:_this.state.password,style:{width:'200px'},onChange:_this.changePassword}),_this.state.visible?/*#__PURE__*/React.createElement(\"button\",{type:\"button\",style:iconStyle,onClick:_this.visibilityChange},/*#__PURE__*/React.createElement(FaEyeSlash,{size:\"2em\"})):/*#__PURE__*/React.createElement(\"button\",{type:\"button\",style:iconStyle,onClick:_this.visibilityChange},/*#__PURE__*/React.createElement(FaEye,{size:\"2em\"})),/*#__PURE__*/React.createElement(\"button\",{className:\"btnb\",style:{marginLeft:'70px'},type:\"submit\"},\"SHRANI\"),/*#__PURE__*/React.createElement(\"button\",{className:\"btnb\",style:{marginLeft:'5px'},onClick:_this.onEditButtonClick},\"PREKLI\\u010CI\")),/*#__PURE__*/React.createElement(\"p\",{style:{color:'red',lineHeight:'40px'}},_this.state.warning),/*#__PURE__*/React.createElement(\"p\",{style:{lineHeight:'40px'}},_this.state.success),/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:'right'}},/*#__PURE__*/React.createElement(\"button\",{id:\"info\",className:\"btnu\",onClick:_this.onEditButtonClick},\"UREDI PODATKE \"),/*#__PURE__*/React.createElement(\"button\",{id:\"pass\",className:\"btnu\",onClick:_this.onEditButtonClick},\" SPREMENI GESLO\"))));}};_this.state={userId:'0',profileInfo:null,password:'',warning:'',success:'',editInfo:false,editPass:false,visible:false};return _this;}_createClass(Profile,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('/sessionroutes',{signal:this.abortController.signal}).then(function(res){return res.json();}).then(function(res){_this2.setState({userId:res.userId});if(res.userId!=='0')_this2.getProfileInfo();}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.abortController.abort();}},{key:\"checkPassStrength\",value:function checkPassStrength(pass){var mediumRegex=new RegExp(\"^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{8,})\");return mediumRegex.test(pass);}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(UpperLine,null),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(BreadCrumbs,{pathname:this.props.location.pathname}),/*#__PURE__*/React.createElement(UserSideBar,null),this.switchRender(),/*#__PURE__*/React.createElement(AdSpace,null),/*#__PURE__*/React.createElement(Bottom,null));}}]);return Profile;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{loggedInUser:state.loggedInUser,loggedInUserId:state.loggedInUserId};};export default connect(mapStateToProps)(Profile);","map":{"version":3,"sources":["/home/katni/REACT/test-app/src/pages/UserPage/Profile.jsx"],"names":["React","connect","UpperLine","Header","NavBar","UserSideBar","Bottom","BreadCrumbs","AdSpace","FaEyeSlash","FaEye","Profile","props","abortController","AbortController","getProfileInfo","fetch","signal","method","headers","body","JSON","stringify","requestType","then","res","json","setState","profileInfo","catch","e","console","error","message","onEditButtonClick","edit","changePhoneNumber","values","value","state","phone_number","changeAddress","target","name","updateInfo","preventDefault","log","editInfo","changePassword","checkPassStrength","warning","password","updatePassword","success","editPass","visibilityChange","visible","id","switchRender","iconStyle","margin","paddingTop","border","backgroundColor","verticalAlign","userId","first_name","last_name","street_ship","post_number_ship","town_ship","width","iban","bic","marginLeft","color","lineHeight","textAlign","abort","pass","mediumRegex","RegExp","test","location","pathname","Component","mapStateToProps","loggedInUser","loggedInUserId"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'react-redux';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport UserSideBar from './UserSideBar';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport AdSpace from '../../components/AdSpace';\nimport { FaEyeSlash, FaEye } from 'react-icons/fa';\nimport '../../App.css';\n\n\nclass Profile extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            userId: '0',\n            profileInfo: null,\n            password: '',\n            warning: '',\n            success: '',\n            editInfo: false,\n            editPass: false,\n            visible: false\n        };\n    }\n\n    abortController = new AbortController();\n\tcomponentDidMount() {\n\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => {this.setState({userId: res.userId}); if(res.userId !== '0') this.getProfileInfo();})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n\n    }\n\n    getProfileInfo = () => {\n        fetch('/profileroutes', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                requestType: 1\n            })\n        })\n        .then(res => res.json())\n        .then(res => this.setState({profileInfo: res[0]}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));   \n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    onEditButtonClick = () => {\n        this.setState({edit: true})\n    }\n    changePhoneNumber = (values) => {\n        const {value} = values;\n        var profileInfo = {...this.state.profileInfo}\n        profileInfo.phone_number = value;\n        this.setState({profileInfo});\n    }\n    changeAddress = (e) => { \n        var profileInfo = {...this.state.profileInfo}\n        const { name, value } = e.target;\n        profileInfo[name] = value;\n        this.setState({profileInfo});\n    }\n\n    updateInfo = (e) =>{\n\n        e.preventDefault();\n        console.log(this.state.profileInfo);\n\n        fetch('/profileroutes', {\n            signal: this.abortController.signal,\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            body: JSON.stringify({\n                requestType: 2,\n                profileInfo: this.state.profileInfo\n            })\n        })\n        .then(res => res.json())\n        .then(() => this.setState({editInfo: false}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n\n    checkPassStrength(pass) {\n        const mediumRegex = new RegExp(\"^(((?=.*[a-z])(?=.*[A-Z]))|((?=.*[a-z])(?=.*[0-9]))|((?=.*[A-Z])(?=.*[0-9])))(?=.{8,})\");\n        return mediumRegex.test(pass);\n    }\n\n    changePassword = (e) => { \n        if(!this.checkPassStrength(e.target.value)){\n            this.setState({\n                warning: 'Geslo mora biti dolgo vsaj 8 znakov in mora vsebovati vsaj dva od naslednjih znakov: mala črka, velika črka, številka.'\n            });\n        } else {\n            this.setState({warning: ''});\n        }\n        this.setState({password: e.target.value});\n    }\n\n    updatePassword = (e) => {\n        e.preventDefault();\n        \n        if(this.state.password !== '' && this.state.warning === '') {\n            fetch('/profileroutes', {\n                signal: this.abortController.signal,\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                },\n                body: JSON.stringify({\n                    requestType: 3,\n                    password: this.state.password\n                })\n            })\n            .then(res => res.json())\n            .then(res => {if(res.success) this.setState({success: 'Uspešno ste spremenili geslo.', editPass: false})})\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n        }\n    }\n    //{if(res[0].success) this.setState({success: 'Uspešno ste spremenili geslo.'}, () => console.log(this.state.success))}\n\n    visibilityChange = () => {\n        this.setState({visible: !this.state.visible})\n    }\n\n    onEditButtonClick = (e) => {\n        if(e.target.id === 'info') {\n            this.setState({editInfo: true});\n        }\n        if(e.target.id === 'pass') {\n            this.setState({editPass: true});\n        }\n        if(e.target.id === 'cancel') {\n            this.setState({editInfo: false, editPass: false});\n        }\n    }\n\n    //{!this.state.editInfo && <p><b>IBAN: </b> {this.state.profileInfo.iban}</p>}\n\n    switchRender = () => {\n        const iconStyle = {\n            margin: 'auto -50px',\n            paddingTop: '0px',\n            border: 'none',\n            backgroundColor: 'rgb(255, 255, 255, 0)',\n            verticalAlign: 'middle'\n        }\n        if(this.state.userId === '0') {\n            return (\n                <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                    <br/><br/><br/>\n                    <h2>PROSIMO PRIJAVITE SE V SISTEM!</h2>\n                    <br/><br/><br/>\n                </div>\n            )\n        }\n        else if(!this.state.profileInfo) {\n            return (<div></div>)\n        } else {\n            return (\n                <div className = 'userContainer'>\n                    <div className = 'profile'>\n                        <br/>\n                        <p><b>IME: </b>{this.state.profileInfo.first_name}</p>\n                        <p><b>PRIIMEK: </b>{this.state.profileInfo.last_name}</p>\n                        {!this.state.editInfo && <p><b>NASLOV ZA POŠILJANJE: </b> {this.state.profileInfo.street_ship + ', ' + this.state.profileInfo.post_number_ship + ' ' + this.state.profileInfo.town_ship}</p>}\n                        {this.state.editInfo && <div><form onSubmit = {this.updateInfo}>\n                                                        <b>NASLOV ZA POŠILJANJE: </b>\n                                                        <input type='text' id='street' name='street_ship' placeholder='Ulica in hišna številka' value={this.state.profileInfo.street_ship} style = {{width: '200px'}} maxLength=\"30\" onChange={this.changeAddress}/>\n                                                        <input type='text' id='postnumber' name='post_number_ship' placeholder='Poštna št.' value={this.state.profileInfo.post_number_ship} style = {{width: '150px'}} maxLength=\"10\" onChange={this.changeAddress}/>\n                                                        <input type='text' id='town' name='town_ship' placeholder='Kraj' value={this.state.profileInfo.town_ship} style = {{width: '150px'}} maxLength=\"30\" onChange={this.changeAddress}/>\n                                                        <br/>\n                                                        <b>TELEFON: </b>\n                                                        <input type='text' id='phonenumber' name='phone_number' value={this.state.profileInfo.phone_number} style = {{width: '200px'}} maxLength=\"20\" onChange={this.changeAddress}/>\n                                                        <br/>\n                                                        <b>IBAN: </b>\n                                                        <input type='text' id='iban' name='iban' value={this.state.profileInfo.iban} style = {{width: '200px'}} maxLength=\"30\" onChange={this.changeAddress}/>\n                                                        <br/>\n                                                        <b>BIC banke: </b>\n                                                        <input type='text' id='bic' name='bic' value={this.state.profileInfo.bic} style = {{width: '200px'}} maxLength=\"10\" onChange={this.changeAddress}/>\n                                                        <br/>\n                                                        <button className = 'btnb' type = 'submit'>SHRANI</button>\n                                                        <button className = 'btnb' style = {{marginLeft: '5px'}} onClick = {this.onEditButtonClick}>PREKLIČI</button>\n                                                        </form></div>}\n\n                        {!this.state.editInfo && <p><b>TELEFON: </b>{this.state.profileInfo.phone_number}</p>}\n                        {!this.state.editInfo && <p><b>IBAN: </b> {this.state.profileInfo.iban}</p>}\n                        {!this.state.editInfo && <p><b>BIC banke: </b> {this.state.profileInfo.bic}</p>}\n\n                        {this.state.editPass &&<form onSubmit = {this.updatePassword}>\n                            SPREMENI GESLO: <input type={this.state.visible ? 'text' : 'password'} id='pass' name='pass' value={this.state.password} style = {{width: '200px'}} onChange={this.changePassword}/>\n                            {this.state.visible ? <button type = 'button' style = {iconStyle} onClick = {this.visibilityChange}>\n                                                        <FaEyeSlash size = '2em'/>\n                                                    </button> :\n                                                    <button type = 'button' style = {iconStyle} onClick = {this.visibilityChange}>\n                                                        <FaEye size = '2em'/>\n                                                    </button>}\n                            <button className = 'btnb' style = {{marginLeft: '70px'}} type = 'submit'>SHRANI</button>\n                            <button className = 'btnb' style = {{marginLeft: '5px'}} onClick = {this.onEditButtonClick}>PREKLIČI</button>\n                        </form>}\n                        <p style = {{color: 'red', lineHeight: '40px'}}>{this.state.warning}</p>\n                        <p style = {{lineHeight: '40px'}}>{this.state.success}</p>\n                        <div style = {{textAlign: 'right'}}><button id = 'info' className = 'btnu' onClick = {this.onEditButtonClick}>UREDI PODATKE </button>\n                        <button id = 'pass' className = 'btnu' onClick = {this.onEditButtonClick}> SPREMENI GESLO</button></div>\n                    </div>\n                </div>\n            )\n        }\n    }\n\n    render() {\n        return (\n            <div className=\"App\">\n            <UpperLine/>\n            <Header/>\n            <NavBar/>\n            <BreadCrumbs pathname = {this.props.location.pathname}/>\n            <UserSideBar/>\n            {this.switchRender()}\n            <AdSpace/>\n            <Bottom/>\n            </div>\n        )\n        \n\n    }\n\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId\n    };\n  };\n\n\nexport default connect(mapStateToProps) (Profile);"]},"metadata":{},"sourceType":"module"}