{"ast":null,"code":"import _classCallCheck from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/katni/APP/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import UpperLine from'../../components/UpperLine';import Header from'../../components/Header';import Bottom from'../../components/Bottom';import BreadCrumbs from'../../components/BreadCrumbs';import CategoryListings from'./CategoryListings';import NavBar from'../../components/NavBar';import{findIndexByValue}from'../../functions/index';import*as Constants from'../../constants';var ListingsPage=/*#__PURE__*/function(_React$Component){_inherits(ListingsPage,_React$Component);var _super=_createSuper(ListingsPage);function ListingsPage(props){var _this;_classCallCheck(this,ListingsPage);_this=_super.call(this,props);_this.abortController=new AbortController();_this.paginationButtonClick=function(e){function subStrBeforeChars(str,char){return str.substring(0,str.indexOf(char));}var location=subStrBeforeChars(window.location.href,'?');var newpage=1;switch(e.target.id){case'first':_this.setState({page:1});window.history.replaceState(null,\"\",location+'?1');break;case'previous':_this.state.page>1?newpage=_this.state.page-1:newpage=1;_this.setState({page:newpage});window.history.replaceState(null,\"\",location+'?'+newpage);break;case'next':_this.state.page<_this.state.numPages?newpage=_this.state.page+1:newpage=_this.state.numPages;_this.setState({page:newpage});window.history.replaceState(null,\"\",location+'?'+newpage);break;case'last':_this.setState({page:_this.state.numPages});window.history.replaceState(null,\"\",location+'?'+_this.state.numPages);break;default:return null;}};_this.sortSelect=function(e){var sortBy=e.target.value;var sortedAds=_this.state.ads;function compareDate(a,b){if(a.ad_id>b.ad_id){return-1;}if(a.ad_id<b.ad_id){return 1;}return 0;}function comparePrice(a,b){if(a.price<b.price){return-1;}if(a.price>b.price){return 1;}return 0;}switch(sortBy){case\"date\":sortedAds.sort(compareDate);break;case\"price\":sortedAds.sort(comparePrice);break;default:break;}_this.setState({ads:sortedAds});};_this.adsDiv=function(){if(_this.state.ads.length===0){return/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",maxWidth:\"90vw\",minHeight:'30vh',justifyContent:'center'}},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h2\",{style:{color:'white'}},\"OPROSTITE, V TEJ KATEGORIJI NI OGLASOV!\")));}else{var numAds=_this.state.ads.length;var n=_this.state.adsPerPage;var p=_this.state.page-1;var till;p*n+n<numAds?till=(p+1)*n:till=numAds;var adsPortion=_this.state.ads.slice(p*n,till);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"right\",marginRight:\"150px\"}},/*#__PURE__*/React.createElement(\"select\",{name:\"sort\",id:\"sort\",onChange:_this.sortSelect},/*#__PURE__*/React.createElement(\"option\",{value:\"date\"},\"Sortiraj\"),/*#__PURE__*/React.createElement(\"option\",{value:\"date\"},\"Najnovej\\u0161e\"),/*#__PURE__*/React.createElement(\"option\",{value:\"price\"},\"Najcenej\\u0161e\"))),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",maxWidth:\"100vw\",paddingLeft:'5vw',paddingRight:'5vw'}},/*#__PURE__*/React.createElement(CategoryListings,{ads:adsPortion})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"button\",{id:\"first\",className:\"btn_nopad\",onClick:_this.paginationButtonClick},\"PRVA\"),/*#__PURE__*/React.createElement(\"button\",{id:\"previous\",className:\"btn_nopad\",onClick:_this.paginationButtonClick},\"<<\"),/*#__PURE__*/React.createElement(\"button\",{id:\"current\",className:\"btn_nopad\"},_this.state.page,\"/\",_this.state.numPages),/*#__PURE__*/React.createElement(\"button\",{id:\"next\",className:\"btn_nopad\",onClick:_this.paginationButtonClick},\">>\"),/*#__PURE__*/React.createElement(\"button\",{id:\"last\",className:\"btn_nopad\",onClick:_this.paginationButtonClick},\"ZADNJA\")));}};_this.state={prevProps:null,ads:[],adsPerPage:5,numPages:1,page:1};return _this;}_createClass(ListingsPage,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;function subStrAfterChars(str,char){return str.substring(str.indexOf(char)+1);}if(window.location.href.includes('?')){var page=parseInt(subStrAfterChars(window.location.href,'?'));this.setState({page:page});}var category;var subcategory;switch(this.props.category){case'women':category=1;this.props.subcategory!=='0'?subcategory=findIndexByValue(Constants.women,this.props.subcategory):subcategory=0;break;case'men':category=2;this.props.subcategory!=='0'?subcategory=findIndexByValue(Constants.men,this.props.subcategory):subcategory=0;break;case'kids':category=3;this.props.subcategory!=='0'?subcategory=findIndexByValue(Constants.kids,this.props.subcategory):subcategory=0;break;default:category=0;subcategory=0;}fetch('/allphotos',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},signal:this.abortController.signal,body:JSON.stringify({type:1,category:category,subcategory:subcategory})}).then(function(res){return res.json();}).then(function(ads){_this2.setState({ads:ads,numPages:Math.floor(ads.length/_this2.state.adsPerPage+0.99)});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.abortController.abort();}},{key:\"render\",value:function render(){var path='';this.props.subcategory==='0'?path='/listings/'+this.props.category+'/all':path='/listings/'+this.props.category+'/'+this.props.subcategory;return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(UpperLine,null),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(BreadCrumbs,{pathname:path}),this.adsDiv(),/*#__PURE__*/React.createElement(Bottom,null));}}]);return ListingsPage;}(React.Component);export default ListingsPage;","map":{"version":3,"sources":["/home/katni/APP/client/src/pages/Listings/ListingsPage.jsx"],"names":["React","UpperLine","Header","Bottom","BreadCrumbs","CategoryListings","NavBar","findIndexByValue","Constants","ListingsPage","props","abortController","AbortController","paginationButtonClick","e","subStrBeforeChars","str","char","substring","indexOf","location","window","href","newpage","target","id","setState","page","history","replaceState","state","numPages","sortSelect","sortBy","value","sortedAds","ads","compareDate","a","b","ad_id","comparePrice","price","sort","adsDiv","length","display","maxWidth","minHeight","justifyContent","color","numAds","n","adsPerPage","p","till","adsPortion","slice","textAlign","marginRight","paddingLeft","paddingRight","prevProps","subStrAfterChars","includes","parseInt","category","subcategory","women","men","kids","fetch","method","headers","signal","body","JSON","stringify","type","then","res","json","Math","floor","catch","console","error","message","abort","path","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport CategoryListings from './CategoryListings';\nimport NavBar from '../../components/NavBar';\nimport {findIndexByValue} from '../../functions/index';\nimport * as Constants from '../../constants';\n\n\nclass ListingsPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            prevProps: null,\n            ads: [],\n            adsPerPage: 5,\n            numPages: 1,\n            page: 1\n        };\n    }\n    \n    abortController = new AbortController();\n\tcomponentDidMount() {\n        function subStrAfterChars(str, char) {\n            return str.substring(str.indexOf(char) + 1);\n        }\n        if(window.location.href.includes('?')) {\n            let page = parseInt(subStrAfterChars(window.location.href, '?'));\n            this.setState({page});\n        }\n        let category;\n        let subcategory;\n\n        switch(this.props.category) {\n            case 'women':\n                category = 1;\n                this.props.subcategory !== '0' ? subcategory = findIndexByValue(Constants.women, this.props.subcategory) : subcategory = 0;\n                break;\n            case 'men':\n                category = 2;\n                this.props.subcategory !== '0' ? subcategory = findIndexByValue(Constants.men, this.props.subcategory) : subcategory = 0;\n                break;\n            case 'kids':\n                category = 3;\n                this.props.subcategory !== '0' ? subcategory = findIndexByValue(Constants.kids, this.props.subcategory) : subcategory = 0;\n                break;\n            default:\n                category = 0;\n                subcategory = 0;\n        }       \n        fetch('/allphotos', {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n            },\n            signal: this.abortController.signal,\n            body: JSON.stringify({\n                type: 1,\n                category: category,\n                subcategory: subcategory\n            })\n        }).then(res => res.json())\n        .then(ads => {this.setState({ads, numPages: Math.floor(ads.length/this.state.adsPerPage + 0.99)})})\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n    }\n\n    paginationButtonClick = (e) => {\n        function subStrBeforeChars(str, char) {\n            return str.substring(0, str.indexOf(char));\n        }\n        const location = subStrBeforeChars(window.location.href, '?');\n        let newpage = 1;\n        switch(e.target.id) {\n            case 'first':\n                this.setState({page: 1});\n                window.history.replaceState(null, \"\", location + '?1');\n                break;\n            case 'previous':\n                this.state.page > 1 ? newpage = this.state.page-1 : newpage = 1;\n                this.setState({page: newpage});\n                window.history.replaceState(null, \"\", location + '?' + newpage);\n                break;\n            case 'next':\n                this.state.page < this.state.numPages ? newpage = this.state.page+1 : newpage = this.state.numPages;\n                this.setState({page: newpage});\n                window.history.replaceState(null, \"\", location + '?' + newpage);\n                break;\n            case 'last':\n                this.setState({page: this.state.numPages});\n                window.history.replaceState(null, \"\", location + '?' + this.state.numPages);\n                break;\n            default:\n                return null;\n        }\n    }\n\n    sortSelect = (e) => {\n\n        const sortBy = e.target.value;\n        let sortedAds = this.state.ads;\n\n        function compareDate( a, b ) {\n            if ( a.ad_id > b.ad_id){\n              return -1;\n            }\n            if ( a.ad_id < b.ad_id ){\n              return 1;\n            }\n            return 0;\n          }\n        function comparePrice( a, b ) {\n            if ( a.price < b.price){\n              return -1;\n            }\n            if ( a.price > b.price ){\n              return 1;\n            }\n            return 0;\n          }\n\n        switch(sortBy) {\n            case \"date\":\n                sortedAds.sort(compareDate);\n                break;\n            case \"price\":\n                sortedAds.sort(comparePrice);\n                break;\n            default:\n                break;\n        }\n        this.setState({ads: sortedAds});\n    }\n\n    adsDiv = () => {\n\n        if (this.state.ads.length === 0) {\n            return (\n                <div style={{display: \"flex\", maxWidth: \"90vw\", minHeight: '30vh', justifyContent: 'center'}}>\n                    <div><h2 style = {{color: 'white'}}>OPROSTITE, V TEJ KATEGORIJI NI OGLASOV!</h2></div>\n                </div>\n            )\n        } else {\n            let numAds = this.state.ads.length;\n            let n = this.state.adsPerPage;\n            let p = this.state.page - 1;\n            let till;\n            p*n + n < numAds ? till = (p+1)*n : till = numAds;\n            let adsPortion = this.state.ads.slice(p*n, till);\n            return (\n                <div>\n                    <div style={{textAlign:\"right\", marginRight:\"150px\"}}>\n                        <select name=\"sort\" id=\"sort\" onChange={this.sortSelect}>\n                            <option value=\"date\">Sortiraj</option>\n                            <option value=\"date\">Najnovejše</option>\n                            <option value=\"price\">Najcenejše</option>\n                        </select>\n                    </div>\n                    <div style={{display: \"flex\", maxWidth: \"100vw\", paddingLeft: '5vw', paddingRight: '5vw'}}>\n                        <CategoryListings ads = {adsPortion}/>\n                    </div>\n                    <div>\n                        <button id='first' className='btn_nopad' onClick={this.paginationButtonClick}>PRVA</button>\n                        <button id='previous' className='btn_nopad' onClick={this.paginationButtonClick}>&#60;&#60;</button>\n                        <button id='current' className='btn_nopad'>{this.state.page}/{this.state.numPages}</button>\n                        <button id='next' className='btn_nopad' onClick={this.paginationButtonClick}>&#62;&#62;</button>\n                        <button id='last' className='btn_nopad' onClick={this.paginationButtonClick}>ZADNJA</button>\n                    </div>\n                </div>\n            )\n        }\n    }\n\n    render() {\n\n        let path = '';\n        this.props.subcategory === '0' ? path = '/listings/' + this.props.category  + '/all' : path = '/listings/' + this.props.category + '/' + this.props.subcategory;\n\n        return <div className=\"App\">\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {path}/>\n                    {this.adsDiv()}\n                    <Bottom/>\n                </div>\n\n    }\n\n}\n\nexport default ListingsPage;\n"]},"metadata":{},"sourceType":"module"}