{"ast":null,"code":"import _classCallCheck from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/katni/REACT/test-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import axios from'axios';import{NavLink}from'react-router-dom';import{connect}from'react-redux';import{saveAtt}from'../../redux/actions';import{doUpload}from'../../functions/index';import ClipLoader from'react-spinners/ClipLoader';import queryString from'query-string';import UpperLine from'../../components/UpperLine';import Header from'../../components/Header';import NavBar from'../../components/NavBar';import ImgUpload from'./ImgUpload';import SelectForms from'./SelectForms';import Bottom from'../../components/Bottom';import BreadCrumbs from'../../components/BreadCrumbs';import'../../App.css';var UploadPage=/*#__PURE__*/function(_React$Component){_inherits(UploadPage,_React$Component);var _super=_createSuper(UploadPage);function UploadPage(props){var _this;_classCallCheck(this,UploadPage);_this=_super.call(this,props);_this.abortController=new AbortController();_this.axiosSignal=axios.CancelToken.source();_this.checkIfAll=function(){var check=true;var selection=_this.state.selection;Object.keys(selection).forEach(function(key){if(key!=='brand'&&key!=='descrtext'){if(selection[key]===0&&selection.category!==3||selection[key]===null||selection[key]===''){check=false;_this.setState({warning:'Izpolni vsa polja'});}}});if(_this.state.photos.length<3){check=false;_this.setState({warning:'Izberi tri fotografije'});}return check;};_this.onImageSaved=function(photo,index){if(_this.state.photos.length<=index){_this.setState(function(state){var photos=state.photos.concat(photo);return{photos:photos};});}else{_this.setState(function(state){var photos=state.photos.map(function(item,j){if(j===index){return photo;}else{return item;}});return{photos:photos};});}};_this.onSelectionSaved=function(selection){_this.setState({selection:selection});};_this.state={userId:'0',adId:'',photos:[],warning:'',uploadStatus:false,selection:{category:'',subcategory:'',clothsize:'',material:'',condition:'',brand:'',descrtext:'',weight:null,price:null},loading:false};_this.handleUpload=_this.handleUpload.bind(_assertThisInitialized(_this));return _this;}_createClass(UploadPage,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;fetch('/sessionroutes',{signal:this.abortController.signal}).then(function(res){return res.json();}).then(function(res){return _this2.setState({userId:res.userId});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});}},{key:\"componentWillUnmount\",value:function componentWillUnmount(){this.abortController.abort();this.axiosSignal.cancel('Api is being canceled');}},{key:\"handleUpload\",value:function handleUpload(){var _this3=this;this.props.saveAtt(true);if(!this.checkIfAll()){this.setState({warning:\"IZPOLNI VSA POLJA!\"});}else{this.setState({loading:true});doUpload('first',this.state.selection,this.props.loggedInUserId,this.props.loggedInUser,this.axiosSignal,0,this.state.photos).then(function(res){return _this3.setState({uploadStatus:true,loading:false});}).catch(function(e){return console.error(\"Critical failure: \"+e.message);});}}},{key:\"render\",value:function render(){var adId=queryString.stringify(queryString.parse(this.props.location.search));if(this.state.userId==='0'){return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(UpperLine,null),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(NavBar,null),/*#__PURE__*/React.createElement(BreadCrumbs,{pathname:this.props.location.pathname}),/*#__PURE__*/React.createElement(\"div\",{style:{backgroundColor:'rgb(255,255,255,0.5)'}},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h2\",null,\"PROSIMO PRIJAVITE SE V SISTEM!\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null)),/*#__PURE__*/React.createElement(Bottom,null));}else if(this.state.uploadStatus){return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h1\",{style:{backgroundColor:'rgb(255, 255, 255, 0.5)'}},\"HVALA ZA ODDANI OGLAS!\"),/*#__PURE__*/React.createElement(NavLink,{exact:true,to:\"/user_listings\"},/*#__PURE__*/React.createElement(\"button\",{className:\"btn\"},\"NAZAJ NA MOJO STRAN\")));}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(UpperLine,null),/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(BreadCrumbs,{pathname:this.props.location.pathname}),/*#__PURE__*/React.createElement(\"div\",{style:{display:\"flex\",width:\"90vw\"}},/*#__PURE__*/React.createElement(\"div\",{className:\"sidenav\"}),/*#__PURE__*/React.createElement(\"div\",{style:{width:\"100%\",backgroundColor:'rgb(255, 255, 255, 0.5)'}},/*#__PURE__*/React.createElement(\"h1\",null,\"OBJAVI OGLAS\"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(SelectForms,{callBackParent:this.onSelectionSaved,saveAtt:this.state.saveAttempt,adId:adId}),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"p\",{style:{fontWeight:'bold'}},\"Nalo\\u017Ei tri fotografije (prva fotografija je naslovna)\"),/*#__PURE__*/React.createElement(ImgUpload,{callBackParent:this.onImageSaved,index:\"0\"}),/*#__PURE__*/React.createElement(ImgUpload,{callBackParent:this.onImageSaved,index:\"1\"}),/*#__PURE__*/React.createElement(ImgUpload,{callBackParent:this.onImageSaved,index:\"2\"}),!this.state.loading&&/*#__PURE__*/React.createElement(\"button\",{className:\"btnb\",onClick:this.handleUpload},\"SHRANI OGLAS\"),/*#__PURE__*/React.createElement(ClipLoader,{size:50,color:\"#123abc\",loading:this.state.loading}),/*#__PURE__*/React.createElement(\"p\",{style:{color:\"red\"}},this.state.warning))),/*#__PURE__*/React.createElement(Bottom,null));}}}]);return UploadPage;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{loggedInUser:state.loggedInUser,loggedInUserId:state.loggedInUserId,saveAttempt:state.saveAttempt};};var mapDispatchToProps={saveAtt:saveAtt};export default connect(mapStateToProps,mapDispatchToProps)(UploadPage);","map":{"version":3,"sources":["/home/katni/REACT/test-app/src/pages/Publish/UploadPage.jsx"],"names":["React","axios","NavLink","connect","saveAtt","doUpload","ClipLoader","queryString","UpperLine","Header","NavBar","ImgUpload","SelectForms","Bottom","BreadCrumbs","UploadPage","props","abortController","AbortController","axiosSignal","CancelToken","source","checkIfAll","check","selection","state","Object","keys","forEach","key","category","setState","warning","photos","length","onImageSaved","photo","index","concat","map","item","j","onSelectionSaved","userId","adId","uploadStatus","subcategory","clothsize","material","condition","brand","descrtext","weight","price","loading","handleUpload","bind","fetch","signal","then","res","json","catch","e","console","error","message","abort","cancel","loggedInUserId","loggedInUser","stringify","parse","location","search","pathname","backgroundColor","display","width","saveAttempt","fontWeight","color","Component","mapStateToProps","mapDispatchToProps"],"mappings":"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","sourcesContent":["import React from 'react';\nimport axios from 'axios';\nimport { NavLink } from 'react-router-dom';\nimport { connect } from 'react-redux';\nimport { saveAtt } from '../../redux/actions';\nimport {doUpload} from '../../functions/index';\nimport ClipLoader from 'react-spinners/ClipLoader';\nimport queryString from 'query-string';\nimport UpperLine from '../../components/UpperLine';\nimport Header from '../../components/Header';\nimport NavBar from '../../components/NavBar';\nimport ImgUpload from './ImgUpload';\nimport SelectForms from './SelectForms';\nimport Bottom from '../../components/Bottom';\nimport BreadCrumbs from '../../components/BreadCrumbs';\nimport '../../App.css';\n\n\nclass UploadPage extends React.Component {\n\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n            userId: '0',\n            adId: '',\n            photos: [],\n            warning: '',\n            uploadStatus: false,\n            selection: {\n                category: '',\n                subcategory: '',\n                clothsize: '',\n                material: '',\n                condition: '',\n                brand: '',\n                descrtext: '',\n                weight: null,\n                price: null\n            },\n            loading: false\n        };\n        this.handleUpload = this.handleUpload.bind(this);\n    }\n\n    abortController = new AbortController();\n    axiosSignal = axios.CancelToken.source();\n\n    componentDidMount() {\n        fetch('/sessionroutes', {signal: this.abortController.signal})\n        .then(res => res.json())\n        .then(res => this.setState({userId: res.userId}))\n        .catch(e => console.error(\"Critical failure: \" + e.message));\n    }\n\n    componentWillUnmount() {\n        this.abortController.abort();\n        this.axiosSignal.cancel('Api is being canceled');\n    }\n\n    checkIfAll = () => {\n        let check = true;\n        const selection = this.state.selection;\n        Object.keys(selection).forEach(key => {\n            if(key !== 'brand' && key !== 'descrtext') {\n                if((selection[key] === 0 && selection.category !== 3)|| selection[key] === null || selection[key] === '') {\n                    check = false;\n                    this.setState({warning: 'Izpolni vsa polja'});\n                }\n            }\n        });\n        if (this.state.photos.length < 3) {\n            check = false;\n            this.setState({warning: 'Izberi tri fotografije'});\n        }\n        return check;\n    }\n\n    onImageSaved = (photo, index) => {\n        if (this.state.photos.length <= index) {\n            this.setState(state => {\n                const photos = state.photos.concat(photo);\n                return {photos};\n            });\n        } else {\n            this.setState(state => {\n                const photos = state.photos.map((item, j) => {\n                    if (j === index) {\n                        return photo;\n                    } else {\n                        return item;\n                    }\n                });\n                return {photos};\n            });\n        }\n    }\n\n    onSelectionSaved = (selection) => {\n        this.setState({selection});\n    }\n\n    handleUpload() {\n        this.props.saveAtt(true);    \n        if (!this.checkIfAll()) {\n            this.setState({warning: \"IZPOLNI VSA POLJA!\"});\n        }else {\n            this.setState({loading: true});\n            doUpload('first', this.state.selection, this.props.loggedInUserId, this.props.loggedInUser, this.axiosSignal, 0, this.state.photos)\n            .then(res => this.setState({uploadStatus: true, loading: false}))\n            .catch(e => console.error(\"Critical failure: \" + e.message));\n        }\n    }\n\n    render() {\n        const adId = queryString.stringify(queryString.parse(this.props.location.search));\n        if(this.state.userId === '0') {\n            return (\n                <div className = 'App'>\n                    <UpperLine/>\n                    <Header/>\n                    <NavBar/>\n                    <BreadCrumbs pathname = {this.props.location.pathname}/>\n                    <div style = {{backgroundColor: 'rgb(255,255,255,0.5)'}}>\n                        <br/><br/><br/>\n                        <h2>PROSIMO PRIJAVITE SE V SISTEM!</h2>\n                        <br/><br/><br/>\n                    </div>\n                    <Bottom/>\n                </div>\n            )\n        }\n        else if(this.state.uploadStatus) {\n            return <div className=\"App\">\n                        <br/><br/>\n                        <h1 style={{backgroundColor: 'rgb(255, 255, 255, 0.5)'}}>HVALA ZA ODDANI OGLAS!</h1>\n                        <NavLink exact to = '/user_listings'><button className = 'btn'>NAZAJ NA MOJO STRAN</button></NavLink>\n                    </div>\n        } else {\n            return (\n            <div className=\"App\">\n                <UpperLine/>\n                <Header/>\n                <BreadCrumbs pathname = {this.props.location.pathname}/>\n                <div style={{display: \"flex\", width: \"90vw\"}}>\n                    <div className=\"sidenav\"></div>\n                    <div style={{width: \"100%\", backgroundColor: 'rgb(255, 255, 255, 0.5)'}}>\n                        <h1>OBJAVI OGLAS</h1>\n                        <br/>\n                        <SelectForms callBackParent={this.onSelectionSaved} saveAtt ={this.state.saveAttempt} adId={adId}/>\n                        <br/>\n                        <p style = {{fontWeight: 'bold'}}>Naloži tri fotografije (prva fotografija je naslovna)</p>\n                        <ImgUpload callBackParent={this.onImageSaved} index='0'/>\n                        <ImgUpload callBackParent={this.onImageSaved} index='1'/>\n                        <ImgUpload callBackParent={this.onImageSaved} index='2'/>\n                        {!this.state.loading && <button className = 'btnb' onClick={this.handleUpload}>SHRANI OGLAS</button>}\n                        <ClipLoader\n                            size={50}\n                            color={\"#123abc\"}\n                            loading={this.state.loading}\n                        />\n                        <p style={{color: \"red\"}}>{this.state.warning}</p>\n                    </div>\n                </div>\n                <Bottom/>\n            </div>\n            )}\n    }\n}\n\nconst mapStateToProps = state => {\n    return {\n      loggedInUser: state.loggedInUser,\n      loggedInUserId: state.loggedInUserId,\n      saveAttempt: state.saveAttempt\n    };\n};\n\nconst mapDispatchToProps = {\n    saveAtt: saveAtt\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps) (UploadPage);\n"]},"metadata":{},"sourceType":"module"}